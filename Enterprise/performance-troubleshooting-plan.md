---
title: Office 365 的效能疑難排解規劃
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
ms.custom: Adm_O365
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: 您需要知道要找出並修正下降、 擱置，以及 SharePoint Online、 商務、 Exchange Online 或商務用 Skype 線上商務用 OneDrive 與您的用戶端電腦之間的效能降低所採取的步驟嗎？ 連絡支援人員之前，這篇文章可協助您疑難排解 Office 365 的效能問題，甚至修正一些最常見的問題。
ms.openlocfilehash: afa24144c1595fd55477e45f4368d99bd4274aca
ms.sourcegitcommit: 08e1e1c09f64926394043291a77856620d6f72b5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/15/2019
ms.locfileid: "34069579"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a><span data-ttu-id="8ac59-104">Office 365 的效能疑難排解規劃</span><span class="sxs-lookup"><span data-stu-id="8ac59-104">Performance troubleshooting plan for Office 365</span></span>

<span data-ttu-id="8ac59-105">您需要知道要找出並修正下降、 擱置，以及 SharePoint Online、 商務、 Exchange Online 或商務用 Skype 線上商務用 OneDrive 與您的用戶端電腦之間的效能降低所採取的步驟嗎？</span><span class="sxs-lookup"><span data-stu-id="8ac59-105">Do you need to know the steps to take to identify and fix lags, hangs, and slow performance between SharePoint Online, OneDrive for Business, Exchange Online, or Skype for Business Online, and your client computer?</span></span> <span data-ttu-id="8ac59-106">連絡支援人員之前，這篇文章可協助您疑難排解 Office 365 的效能問題，甚至修正一些最常見的問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-106">Before you call support, this article can help you troubleshoot Office 365 performance issues and even fix some of the most common issues.</span></span>
  
<span data-ttu-id="8ac59-107">本文是實際範例巨集指令計劃，您可以使用擷取的效能問題的相關重要的資料，就像情形。</span><span class="sxs-lookup"><span data-stu-id="8ac59-107">This article is actually a sample action plan that you can use to capture valuable data about your performance issue as it's happening.</span></span> <span data-ttu-id="8ac59-108">本文也會包含一些上方的問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-108">Some top issues are also included in this article.</span></span>

<span data-ttu-id="8ac59-109">如果您是初次使用網路效能和想要讓長期計劃監視用戶端電腦與 Office 365 之間的效能，看看在[Office 365 效能調整和疑難排解的系統管理員和 IT 專業人員](performance-tuning-using-baselines-and-history.md)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-109">If you're new to network performance and want to make a long term plan to monitor performance between your client machines and Office 365, take a look at [Office 365 performance tuning and troubleshooting - Admin and IT Pro](performance-tuning-using-baselines-and-history.md).</span></span>
  
## <a name="sample-performance-troubleshooting-action-plan"></a><span data-ttu-id="8ac59-110">範例效能疑難排解行動計畫</span><span class="sxs-lookup"><span data-stu-id="8ac59-110">Sample performance troubleshooting action plan</span></span>

<span data-ttu-id="8ac59-111">此巨集指令計劃包含兩個部分;準備階段，並記錄階段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-111">This action plan contains two parts; a preparation phase, and a logging phase.</span></span> <span data-ttu-id="8ac59-112">如果您有效能問題是現在不用]，且您不必執行資料集合，您可以開始立即使用此計劃。</span><span class="sxs-lookup"><span data-stu-id="8ac59-112">If you have a performance problem right now, and you need to do data collection, you can start using this plan right away.</span></span>
  
### <a name="prepare-the-client-computer"></a><span data-ttu-id="8ac59-113">準備用戶端電腦</span><span class="sxs-lookup"><span data-stu-id="8ac59-113">Prepare the client computer</span></span>
  
- <span data-ttu-id="8ac59-114">尋找也發生效能問題的用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="8ac59-114">Find a client computer that can reproduce the performance problem.</span></span> <span data-ttu-id="8ac59-115">此電腦將用於疑難排解的過程中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-115">This computer will be used during the course of troubleshooting.</span></span>
- <span data-ttu-id="8ac59-116">請記下會造成效能問題，才能讓您準備好提到時間進行測試時，即會發生的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-116">Write down the steps that cause the performance problem to happen so you're ready when it comes time to test.</span></span>
- <span data-ttu-id="8ac59-117">安裝收集和記錄資訊的工具：</span><span class="sxs-lookup"><span data-stu-id="8ac59-117">Install tools for gathering and recording information:</span></span>
  - <span data-ttu-id="8ac59-118">安裝[Netmon 3.4](https://www.microsoft.com/en-us/download/details.aspx?id=4865) （或使用對等網路追蹤工具）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-118">Install [Netmon 3.4](https://www.microsoft.com/en-us/download/details.aspx?id=4865) (or use an equivalent network tracing tool).</span></span>
  - <span data-ttu-id="8ac59-119">安裝[HTTPWatch](https://www.httpwatch.com/download/)免費基本版 （或使用對等網路追蹤工具）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-119">Install the free Basic Edition of [HTTPWatch](https://www.httpwatch.com/download/) (or use an equivalent network Tracing tool).</span></span>
  - <span data-ttu-id="8ac59-120">使用螢幕錄製器，或執行步驟收錄程式 (PSR.exe) 隨附在 Windows vista 及更新版本中，以保留記錄的測試期間所採取的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-120">Use a screen recorder or run the Steps Recorder (PSR.exe) that comes with Windows Vista and later, in order to keep a record of the steps you take during testing.</span></span>

### <a name="log-the-performance-issue"></a><span data-ttu-id="8ac59-121">記錄效能問題</span><span class="sxs-lookup"><span data-stu-id="8ac59-121">Log the performance issue</span></span>
  
- <span data-ttu-id="8ac59-122">關閉所有無關的網際網路瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="8ac59-122">Close all extraneous Internet browsers.</span></span>
- <span data-ttu-id="8ac59-123">啟動步驟收錄程式或另一個螢幕錄製。</span><span class="sxs-lookup"><span data-stu-id="8ac59-123">Start the Steps Recorder, or another screen recorder.</span></span>
- <span data-ttu-id="8ac59-124">啟動您的 Netmon 擷取 （或網路追蹤工具）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-124">Start your Netmon capture (or network tracing tool).</span></span>
- <span data-ttu-id="8ac59-125">清除您的 DNS 快取，用戶端電腦從命令列上輸入 ipconfig /flushdns。</span><span class="sxs-lookup"><span data-stu-id="8ac59-125">Clear your DNS cache on the client computer from the command line by typing ipconfig /flushdns.</span></span>
- <span data-ttu-id="8ac59-126">啟動新的瀏覽器工作階段，並開啟 HTTPWatch。</span><span class="sxs-lookup"><span data-stu-id="8ac59-126">Start a new browser session and turn on HTTPWatch.</span></span>
- <span data-ttu-id="8ac59-127">選用： 如果您正在測試 Exchange Online，執行 Exchange 用戶端效能分析器工具從 Office 365 系統管理主控台。</span><span class="sxs-lookup"><span data-stu-id="8ac59-127">Optional: If you are testing Exchange Online, run the Exchange Client Performance Analyzer tool from the Office 365 admin console.</span></span>
- <span data-ttu-id="8ac59-128">重現會造成效能問題的確切步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-128">Reproduce the exact steps that cause the performance issue.</span></span>
- <span data-ttu-id="8ac59-129">停止您 Netmon 或其他工具追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-129">Stop your Netmon or other tool's trace.</span></span>
- <span data-ttu-id="8ac59-130">在命令列中，執行追蹤路由傳送至您的 Office 365 訂閱中輸入下列命令並按 ENTER:</span><span class="sxs-lookup"><span data-stu-id="8ac59-130">At the command line, run a trace route to your Office 365 subscription by typing the following command and then pressing ENTER:</span></span>

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- <span data-ttu-id="8ac59-131">停止步驟收錄程式，並儲存的視訊。</span><span class="sxs-lookup"><span data-stu-id="8ac59-131">Stop the Steps Recorder and save the video.</span></span> <span data-ttu-id="8ac59-132">請務必包含的日期和時間擷取及是否會示範良好或不正確的效能。</span><span class="sxs-lookup"><span data-stu-id="8ac59-132">Be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>
- <span data-ttu-id="8ac59-133">儲存追蹤檔案。</span><span class="sxs-lookup"><span data-stu-id="8ac59-133">Save the trace files.</span></span> <span data-ttu-id="8ac59-134">同樣地，請務必包含的日期和時間擷取及是否會示範良好或不正確的效能。</span><span class="sxs-lookup"><span data-stu-id="8ac59-134">Again, be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>

<span data-ttu-id="8ac59-135">如果您不熟悉執行本文中提及的工具，不用擔心因為我們會提供這些步驟下一步]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-135">If you're not familiar with running the tools mentioned in this article, don't worry because we provide those steps next.</span></span> <span data-ttu-id="8ac59-136">如果您已經習慣執行這類擷取網路，您可以略過[如何收集基準](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)，其中會說明篩選和讀取記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8ac59-136">If you're accustomed to doing this kind of network capturing, you can skip to [How to collect baselines](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines), which describes filtering and reading the logs.</span></span>
  
### <a name="flush-the-dns-cache-first"></a><span data-ttu-id="8ac59-137">先清除 DNS 快取</span><span class="sxs-lookup"><span data-stu-id="8ac59-137">Flush the DNS Cache first</span></span>

<span data-ttu-id="8ac59-138">為什麼？</span><span class="sxs-lookup"><span data-stu-id="8ac59-138">Why?</span></span> <span data-ttu-id="8ac59-139">藉由出 DNS 快取清除中您要從頭開始測試。</span><span class="sxs-lookup"><span data-stu-id="8ac59-139">By flushing out the DNS cache you're starting your tests with a clean slate.</span></span> <span data-ttu-id="8ac59-140">藉由清除快取，您正在重 DNS 解析程式內容設為最新的項目。</span><span class="sxs-lookup"><span data-stu-id="8ac59-140">By clearing the cache, you're resetting the DNS resolver contents to the most up-to-date entries.</span></span> <span data-ttu-id="8ac59-141">請記住，儲存變更並不會移除 HOSTs 檔案項目。</span><span class="sxs-lookup"><span data-stu-id="8ac59-141">Remember that a flush does not remove HOSTs file entries.</span></span> <span data-ttu-id="8ac59-142">如果廣泛使用主機檔案項目，您應該將這些項目複製到另一個目錄中的檔案，並再清空主機檔案。</span><span class="sxs-lookup"><span data-stu-id="8ac59-142">If you use HOST file entries extensively, you should copy those entries out to a file in another directory and then empty the HOST file.</span></span>
  
#### <a name="flush-your-dns-resolver-cache"></a><span data-ttu-id="8ac59-143">清除您的 DNS 解析程式快取</span><span class="sxs-lookup"><span data-stu-id="8ac59-143">Flush your DNS resolver cache</span></span>
  
1. <span data-ttu-id="8ac59-144">開啟命令提示字元 (**啟動**任一\>**執行** \> **cmd**或**Windows 鍵** \> **cmd**)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-144">Open the command prompt, (either **Start** \> **Run** \> **cmd** or **Windows key** \> **cmd**).</span></span>
2. <span data-ttu-id="8ac59-145">輸入下列命令，然後按 ENTER：</span><span class="sxs-lookup"><span data-stu-id="8ac59-145">Type the following command and press ENTER:</span></span>

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a><span data-ttu-id="8ac59-146">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-146">Netmon</span></span>

<span data-ttu-id="8ac59-147">Microsoft 的網路監視工具 ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) 會分析封包，是在網路上的電腦之間傳送的流量。</span><span class="sxs-lookup"><span data-stu-id="8ac59-147">Microsoft's Network Monitoring tool ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) analyzes packets, that is traffic, that passes between computers on networks.</span></span> <span data-ttu-id="8ac59-148">使用追蹤流量與 Office 365 您可以擷取，檢視中，並讀取封包標頭、 識別中間的裝置，請檢查網路硬體上的重要設定 Netmon，尋找捨棄封包，並遵循上您公司的電腦之間的流量傳送網路和 Office 365。</span><span class="sxs-lookup"><span data-stu-id="8ac59-148">By using Netmon to trace traffic with Office 365 you can capture, view, and read packet headers, identify intervening devices, check important settings on network hardware, look for dropped packets, and follow the flow of traffic between computers on your corporate network and Office 365.</span></span> <span data-ttu-id="8ac59-149">因為實際的主體的流量加密，也就是它 （透過 SSL/TLS 的連接埠 443 上旅行您無法讀取檔案傳送。</span><span class="sxs-lookup"><span data-stu-id="8ac59-149">Because the actual body of the traffic is encrypted, that is, it(travels on port 443 via SSL/TLS, you can't read the files being sent.</span></span> <span data-ttu-id="8ac59-150">相反地，您會收到未篩選的追蹤的封包採取可協助您追蹤問題行為的路徑。</span><span class="sxs-lookup"><span data-stu-id="8ac59-150">Instead, you get an unfiltered trace of the path that the packet takes which can help you track down the problem behavior.</span></span>
  
<span data-ttu-id="8ac59-151">請確定您未在此階段套用篩選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-151">Be sure you don't apply a filter at this time.</span></span> <span data-ttu-id="8ac59-152">相反地，完成的步驟執行，並示範之前停止追蹤和儲存的問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-152">Instead, run through the steps and demonstrate the problem before stopping the trace and saving.</span></span>
  
<span data-ttu-id="8ac59-153">在您安裝 Netmon 3.4 之後，開啟工具]，並採取下列步驟：</span><span class="sxs-lookup"><span data-stu-id="8ac59-153">After you install Netmon 3.4, open the tool and take these steps:</span></span>
  
### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a><span data-ttu-id="8ac59-154">Netmon 追蹤並重現問題</span><span class="sxs-lookup"><span data-stu-id="8ac59-154">Take a Netmon trace and reproduce the issue</span></span>
  
1. <span data-ttu-id="8ac59-155">啟動 Netmon 3.4。</span><span class="sxs-lookup"><span data-stu-id="8ac59-155">Launch Netmon 3.4.</span></span>
<span data-ttu-id="8ac59-156">在 [**開始**] 頁面上有三個窗格：**最近擷取**、**選取 [網路**和**與 Microsoft Network Monitor 3.4 快速入門。請注意**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-156">There are three panes on the **Start** page: **Recent Captures**, **Select Networks**, and the **Getting Started with Microsoft Network Monitor 3.4. Notice**.</span></span> <span data-ttu-id="8ac59-157">選取 [網路] 面板也會提供您的您可以從中擷取預設網路清單。</span><span class="sxs-lookup"><span data-stu-id="8ac59-157">The Select Networks panel will also give you a list of the default networks from which you can capture.</span></span> <span data-ttu-id="8ac59-158">請確定網路卡此處所選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-158">Be sure that network cards are selected here.</span></span>

2. <span data-ttu-id="8ac59-159">按一下 [頂端的 [**開始**] 頁面上的 [**新擷取**]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-159">Click **New Capture** at the top of the **Start** page.</span></span> <span data-ttu-id="8ac59-160">這會新增名為**擷取 1**的**開始**頁面索引標籤旁的新索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-160">This adds a new tab beside the **Start** page tab called **Capture 1**.</span></span>
<span data-ttu-id="8ac59-161">![Netmon 的使用者介面與新擷取，開始，並停止反白顯示的按鈕。](media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span><span class="sxs-lookup"><span data-stu-id="8ac59-161">![Netmon's user interface with the New Capture, Start, and Stop buttons highlighted.](media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span></span>

3. <span data-ttu-id="8ac59-162">若要執行簡單擷取，按一下 [**開始**] 工具列上。</span><span class="sxs-lookup"><span data-stu-id="8ac59-162">To take a simple capture, click **Start** on the toolbar.</span></span>

4. <span data-ttu-id="8ac59-163">重現呈現的效能問題的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-163">Reproduce the steps that present a performance issue.</span></span>

5. <span data-ttu-id="8ac59-164">按一下 [**停止** \> **檔案** \> **另存為**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-164">Click **Stop** \> **File** \> **Save As**.</span></span> <span data-ttu-id="8ac59-165">請記得提供的日期和時間的時區，並涵蓋如果它會示範不正確或良好的效能。</span><span class="sxs-lookup"><span data-stu-id="8ac59-165">Remember to give the date and time with the time zone and to mention if it demonstrates bad or good performance.</span></span>

## <a name="httpwatch"></a><span data-ttu-id="8ac59-166">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="8ac59-166">HTTPWatch</span></span>

<span data-ttu-id="8ac59-167">[HTTPWatch](https://www.httpwatch.com/download/)有充電，和免費版。</span><span class="sxs-lookup"><span data-stu-id="8ac59-167">[HTTPWatch](https://www.httpwatch.com/download/) comes in charged, and a free edition.</span></span> <span data-ttu-id="8ac59-168">免費的基本版涵蓋您需要這項測試的所有項目。</span><span class="sxs-lookup"><span data-stu-id="8ac59-168">The free Basic Edition covers everything you need for this test.</span></span> <span data-ttu-id="8ac59-169">HTTPWatch 監視網路流量以及頁面載入時間直接從瀏覽器視窗。</span><span class="sxs-lookup"><span data-stu-id="8ac59-169">HTTPWatch monitors network traffic and page load time right from your browser window.</span></span> <span data-ttu-id="8ac59-170">HTTPWatch 是要以圖形方式說明效能的 Internet Explorer 的外掛程式。</span><span class="sxs-lookup"><span data-stu-id="8ac59-170">HTTPWatch is a plug-in to Internet Explorer that graphically describes performance.</span></span> <span data-ttu-id="8ac59-171">分析可儲存及 HTTPWatch Studio 中檢視。</span><span class="sxs-lookup"><span data-stu-id="8ac59-171">The analysis can be saved and viewed in HTTPWatch Studio.</span></span>
  
> [!NOTE]
> <span data-ttu-id="8ac59-172">如果您使用另一個瀏覽器，例如 Firefox、 Google Chrome 或您不能安裝 HTTPWatch Internet Explorer 中，開啟新的瀏覽器視窗，並按下鍵盤上的 F12。</span><span class="sxs-lookup"><span data-stu-id="8ac59-172">If you use another browser, such as Firefox, Google Chrome, or if you can't install HTTPWatch in Internet Explorer, open a new browser window and press F12 on your keyboard.</span></span> <span data-ttu-id="8ac59-173">您應該會看到開發人員工具快顯視窗底部的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="8ac59-173">You should see the Developer Tool pop-up at the bottom of your browser.</span></span> <span data-ttu-id="8ac59-174">如果您使用 Opera，Web 檢查員按 CTRL + SHIFT + I，然後按一下 [**網路**] 索引標籤再完成以下所述的測試。</span><span class="sxs-lookup"><span data-stu-id="8ac59-174">If you use Opera, press CTRL+SHIFT+I for Web Inspector, then click the **Network** tab and complete the testing outlined below.</span></span> <span data-ttu-id="8ac59-175">資訊會稍有不同，但仍會顯示載入時間 （毫秒）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-175">The information will be slightly different, but load times will still be displayed in milliseconds.</span></span> <span data-ttu-id="8ac59-176">> HTTPWatch 也是很有用的 SharePoint Online 頁面載入時間的問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-176">> HTTPWatch is also very useful for issues with SharePoint Online page load times.</span></span>
  
### <a name="run-httpwatch-and-reproduce-the-issue"></a><span data-ttu-id="8ac59-177">執行 HTTPWatch 和重現問題</span><span class="sxs-lookup"><span data-stu-id="8ac59-177">Run HTTPWatch and reproduce the issue</span></span>
  
<span data-ttu-id="8ac59-178">HTTPWatch 是瀏覽器外掛程式，因此公開在瀏覽器工具會稍有不同的每個版本的 Internet Explorer。</span><span class="sxs-lookup"><span data-stu-id="8ac59-178">HTTPWatch is a browser plug-in, so exposing the tool in the browser is slightly different for each version of Internet Explorer.</span></span> <span data-ttu-id="8ac59-179">一般而言，您可以在命令列的下方找到 HTTPWatch Internet Explorer 瀏覽器中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-179">Typically, you can find HTTPWatch under the Commands bar in the Internet Explorer browser.</span></span> <span data-ttu-id="8ac59-180">如果您沒有看到外掛程式 HTTPWatch 瀏覽器視窗中，檢查您的瀏覽器的版本即可**協助** \> **有關**，或在更新版本的 Internet Explorer，按一下 [齒輪符號**關於 Internet Explorer**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-180">If you don't see the HTTPWatch plug-in in your browser window, check the version of your browser by clicking **Help** \> **About**, or in later versions of Internet Explorer, click the gear symbol and **About Internet Explorer**.</span></span> <span data-ttu-id="8ac59-181">若要啟動的**命令**列，Internet Explorer 中的功能表列上按一下滑鼠右鍵，然後按一下**命令列**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-181">To launch the **Commands** bar, right-click the menu bar in Internet Explorer and click **Commands bar**.</span></span>

<span data-ttu-id="8ac59-182">在過去，HTTPWatch 已相關命令與瀏覽器列中，因此一次您安裝時，如果您沒有立即看到檢查**工具**，以及您工具列圖示的圖示 （即使後重新開機）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-182">In the past, HTTPWatch has been associated with both the Commands and the Explorer bars, so once you install, if you don't immediately see the icon (even after reboot) check **Tools**, and your toolbars for the icon.</span></span> <span data-ttu-id="8ac59-183">請記住，您可以自訂工具列，選項可將它們加入。</span><span class="sxs-lookup"><span data-stu-id="8ac59-183">Remember that toolbars can be customized and options can be added to them.</span></span>

![Internet Explorer 的命令工具列顯示的 HTTPWatch 圖示。](media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)
  
1. <span data-ttu-id="8ac59-185">啟動 Internet Explorer 瀏覽器視窗中的 HTTPWatch。</span><span class="sxs-lookup"><span data-stu-id="8ac59-185">Launch HTTPWatch in an Internet Explorer browser window.</span></span> <span data-ttu-id="8ac59-186">它會顯示固定至該視窗底部的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="8ac59-186">It will appear docked to the browser at the bottom of that window.</span></span> <span data-ttu-id="8ac59-187">按一下 [**記錄**]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-187">Click **Record**.</span></span>

2. <span data-ttu-id="8ac59-188">重現參與效能問題的的確切步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-188">Reproduce the exact steps involved in the performance issue.</span></span> <span data-ttu-id="8ac59-189">按一下 [HTTPWatch 中的 [**停止**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="8ac59-189">Click the **Stop** button in HTTPWatch.</span></span>

3. <span data-ttu-id="8ac59-190">HTTPWatch 或**傳送的電子郵件**，[**儲存**]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-190">**Save** the HTTPWatch or **Send by Email**.</span></span> <span data-ttu-id="8ac59-191">請記得，使其包含的日期和時間的資訊和指示您的監看是否包含的良好或不正確的效能示範做為檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="8ac59-191">Remember to name the file so that it includes date and time information and an indication of whether your Watch contains a demonstration of good or bad performance.</span></span>

![HTTPWatch，顯示 Office 365 首頁的頁面載入之 [網路] 索引標籤。](media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

<span data-ttu-id="8ac59-193">這個螢幕擷取畫面會從 HTTPWatch 專業版。</span><span class="sxs-lookup"><span data-stu-id="8ac59-193">This screen shot is from the Professional version of HTTPWatch.</span></span> <span data-ttu-id="8ac59-194">您可以開啟含有專業版的電腦上的基本版本中所採取的追蹤項目和那里讀取。</span><span class="sxs-lookup"><span data-stu-id="8ac59-194">You can open traces taken in the Basic Version on a computer with a Professional version and read it there.</span></span> <span data-ttu-id="8ac59-195">額外的資訊可能會提供追蹤透過該方法。</span><span class="sxs-lookup"><span data-stu-id="8ac59-195">Extra information may be available from the trace through that method.</span></span>

## <a name="problem-steps-recorder"></a><span data-ttu-id="8ac59-196">問題步驟收錄程式</span><span class="sxs-lookup"><span data-stu-id="8ac59-196">Problem Steps Recorder</span></span>

<span data-ttu-id="8ac59-197">步驟收錄程式或 PSR.exe，可讓您記錄問題，因為它們發生。</span><span class="sxs-lookup"><span data-stu-id="8ac59-197">Steps Recorder, or PSR.exe, allows you to record issues as they are occurring.</span></span> <span data-ttu-id="8ac59-198">這是很有用的工具和非常簡單，執行。</span><span class="sxs-lookup"><span data-stu-id="8ac59-198">It's a very useful tool and very simple to run.</span></span>
  
### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a><span data-ttu-id="8ac59-199">執行問題步驟收錄程式 (PSR.exe) 來記錄您的工作</span><span class="sxs-lookup"><span data-stu-id="8ac59-199">Run Problem Steps Recorder (PSR.exe) to record your work</span></span>
  
1. <span data-ttu-id="8ac59-200">使用**開始** \> **執行**\>輸入**PSR.exe** \> **[確定]**，或者按一下 [ **Windows 鍵**\>輸入**PSR.exe** \> ，然後按 ENTER。</span><span class="sxs-lookup"><span data-stu-id="8ac59-200">Either use **Start** \> **Run** \> type **PSR.exe** \> **OK**, or, click the **Windows Key** \> type **PSR.exe** \> and then press ENTER.</span></span>

2. <span data-ttu-id="8ac59-201">小型 PSR.exe 視窗出現時，按一下 [**開始錄製**並重現重現效能問題的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-201">When the small PSR.exe window appears, click **Start Record** and reproduce the steps that reproduce the performance issue.</span></span> <span data-ttu-id="8ac59-202">如有需要按一下 [**新增註解**，您可以新增註解。</span><span class="sxs-lookup"><span data-stu-id="8ac59-202">You can add comments as needed, by clicking **Add Comments**.</span></span>

3. <span data-ttu-id="8ac59-203">當您已完成的步驟，請按一下 [**停止記錄**]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-203">Click **Stop Record** when you have completed the steps.</span></span> <span data-ttu-id="8ac59-204">] 頁面上呈現效能問題時，等候轉譯之前停止錄製] 頁面。</span><span class="sxs-lookup"><span data-stu-id="8ac59-204">If the performance issue is a page render, wait for the page to render before you stop the recording.</span></span>

4. <span data-ttu-id="8ac59-205">按一下 [儲存]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8ac59-205">Click **Save**.</span></span>

![步驟收錄程式或 PSR.exe 的螢幕擷取畫面。](media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)
  
<span data-ttu-id="8ac59-207">為您記錄的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-207">The date and time is recorded for you.</span></span> <span data-ttu-id="8ac59-208">此連結您 PSR Netmon 追蹤及 HTTPWatch 的時間，並協助精確度疑難排解。</span><span class="sxs-lookup"><span data-stu-id="8ac59-208">This links your PSR to your Netmon trace and HTTPWatch in time, and helps with precision troubleshooting.</span></span> <span data-ttu-id="8ac59-209">PSR 記錄中的時間與日期可以顯示一分鐘的傳遞登入與例如瀏覽的 URL 及管理網站中，部分轉譯之間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-209">The date and time in the PSR record can show that a minute passed between the login and browsing of the URL and the partial render of the admin site, for example.</span></span>
  
## <a name="read-your-traces"></a><span data-ttu-id="8ac59-210">讀取您追蹤</span><span class="sxs-lookup"><span data-stu-id="8ac59-210">Read your traces</span></span>

<span data-ttu-id="8ac59-211">因為不可能教導每個項目網路和效能問題的疑難排解的相關的其他人必須知道透過文章。</span><span class="sxs-lookup"><span data-stu-id="8ac59-211">It isn't possible to teach everything about network and performance troubleshooting that someone would need to know via an article.</span></span> <span data-ttu-id="8ac59-212">取得在效能良好採用體驗，而您的網路的運作方式與通常會執行的知識。</span><span class="sxs-lookup"><span data-stu-id="8ac59-212">Getting good at performance takes experience, and knowledge of how your network works and usually performs.</span></span> <span data-ttu-id="8ac59-213">但可能要無條件進位的頂端的問題清單，並顯示如何工具可以讓更容易，以消除最常見的問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-213">But it is possible to round up a list of top issues and show how tools can make it easier for you to eliminate the most common problems.</span></span>
  
<span data-ttu-id="8ac59-214">如果您想要揀選技術閱讀 Office 365 網站的網路追蹤，沒有任何更好教師比定期建立的頁面載入追蹤和取得讀取它們的經驗。</span><span class="sxs-lookup"><span data-stu-id="8ac59-214">If you want to pick up skills reading network traces for your Office 365 sites, there is no better teacher than creating traces of page loads regularly and gaining experience reading them.</span></span> <span data-ttu-id="8ac59-215">例如，當您有機會，載入 Office 365 服務和追蹤程序。</span><span class="sxs-lookup"><span data-stu-id="8ac59-215">For example, when you have a chance, load an Office 365 service and trace the process.</span></span> <span data-ttu-id="8ac59-216">篩選追蹤 DNS 流量，或搜尋 FrameData 您瀏覽之服務的名稱。</span><span class="sxs-lookup"><span data-stu-id="8ac59-216">Filter the trace for DNS traffic, or search the FrameData for the name of the service you browsed.</span></span> <span data-ttu-id="8ac59-217">掃描的追蹤，以了解發生服務載入時的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-217">Scan the trace to get an idea of the steps that occur when the service loads.</span></span> <span data-ttu-id="8ac59-218">這可協助您了解哪些 normal 載入頁面的外觀和若是進行疑難排解，周圍的效能，尤其是比較好到錯誤的追蹤項目可以教您很多。</span><span class="sxs-lookup"><span data-stu-id="8ac59-218">This will help you learn what normal page load should look like, and in the case of troubleshooting, particularly around performance, comparing good to bad traces can teach you a lot.</span></span>
  
<span data-ttu-id="8ac59-219">Netmon 會使用 Microsoft Intellisense 中顯示篩選器] 欄位。</span><span class="sxs-lookup"><span data-stu-id="8ac59-219">Netmon uses Microsoft Intellisense in the Display filter field.</span></span> <span data-ttu-id="8ac59-220">Intellisense 或智慧型程式碼完成時，為該手法您在一段中輸入，並在下拉式清單選取項目] 方塊中顯示所有可用的選項。</span><span class="sxs-lookup"><span data-stu-id="8ac59-220">Intellisense, or intelligent code completion, is that trick where you type in a period and all available options are displayed in a drop-down selection box.</span></span> <span data-ttu-id="8ac59-221">如果，例如，您擔心 TCP 視窗縮放，您可以找到您對篩選器的方式 (例如： `.protocol.tcp.window < 100`) 用這種方法。</span><span class="sxs-lookup"><span data-stu-id="8ac59-221">If, for example, you are worried about TCP window scaling, you can find your way to a filter (such as  `.protocol.tcp.window < 100`) by this means.</span></span>
  
![螢幕擷取畫面的 Netmon，顯示的 [顯示篩選器] 欄位使用 intellisense。](media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)
  
<span data-ttu-id="8ac59-223">Netmon 追蹤項目可以有大量的流量。</span><span class="sxs-lookup"><span data-stu-id="8ac59-223">Netmon traces can have a lot of traffic in them.</span></span> <span data-ttu-id="8ac59-224">如果您不熟悉讀取它們，很可能會是淹沒開啟追蹤第一次。</span><span class="sxs-lookup"><span data-stu-id="8ac59-224">If you aren't experienced with reading them, it's likely you will be overwhelmed opening the trace the first time.</span></span> <span data-ttu-id="8ac59-225">第一件事是接收的訊號隔開追蹤背景噪音。</span><span class="sxs-lookup"><span data-stu-id="8ac59-225">The first thing to do is separate the signal from the background noise in the trace.</span></span> <span data-ttu-id="8ac59-226">比照 Office 365，也就是您想要查看的流量。</span><span class="sxs-lookup"><span data-stu-id="8ac59-226">You tested against Office 365, and that's the traffic you want to see.</span></span> <span data-ttu-id="8ac59-227">如果您是使用巡覽追蹤，您可能不需要此清單。</span><span class="sxs-lookup"><span data-stu-id="8ac59-227">If you are used to navigating through traces, you may not need this list.</span></span>
  
<span data-ttu-id="8ac59-228">用戶端和 Office 365 之間的流量流經透過 TLS，這表示流量的本文將會受到加密，並在一般的 Netmon 追蹤不容易閱讀。</span><span class="sxs-lookup"><span data-stu-id="8ac59-228">Traffic between your client and Office 365 travels via TLS, which means that the body of the traffic will be encrypted and not readable in a generic Netmon trace.</span></span> <span data-ttu-id="8ac59-229">效能分析不需要知道的封包中的資訊細節。</span><span class="sxs-lookup"><span data-stu-id="8ac59-229">Your performance analysis doesn't need to know the specifics of the information in the packet.</span></span> <span data-ttu-id="8ac59-230">不過，非常感興趣的封包標頭和所包含的資訊。</span><span class="sxs-lookup"><span data-stu-id="8ac59-230">It is, however, very interested in packet headers and the information that they contain.</span></span>
  
### <a name="tips-to-get-a-good-trace"></a><span data-ttu-id="8ac59-231">若要取得的良好的追蹤的祕訣</span><span class="sxs-lookup"><span data-stu-id="8ac59-231">Tips to get a good trace</span></span>
  
- <span data-ttu-id="8ac59-232">了解您的用戶端電腦的 IPv4 或 IPv6 位址的值。</span><span class="sxs-lookup"><span data-stu-id="8ac59-232">Know the value of the IPv4 or IPv6 address of your client computer.</span></span> <span data-ttu-id="8ac59-233">您可以透過此命令提示字元中輸入**IPConfig** ，然後按 ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="8ac59-233">You can get this from the command prompt by typing **IPConfig** and then pressing ENTER.</span></span> <span data-ttu-id="8ac59-234">了解這個地址會讓您一眼告訴是否追蹤中的流量直接牽涉到您的用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="8ac59-234">Knowing this address will let you tell at a glance whether the traffic in the trace directly involves your client computer.</span></span> <span data-ttu-id="8ac59-235">如果沒有已知的 proxy，ping 它並取得其 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-235">If there is a known proxy, ping it and get its IP address as well.</span></span>

- <span data-ttu-id="8ac59-236">清除您的 DNS 解析程式快取，如果可能，請關閉所有瀏覽器的那一您執行測試。</span><span class="sxs-lookup"><span data-stu-id="8ac59-236">Flush your DNS resolver cache and, if possible, close all browsers except the one in which you are running your tests.</span></span> <span data-ttu-id="8ac59-237">如果您不能這麼做，例如，如果支援使用某些瀏覽器型的工具若要查看您的用戶端電腦桌面，就會準備好篩選您追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-237">If you are not able to do this, for instance, if support is using some browser-based tool to see your client computer's desktop, be prepared to filter your trace.</span></span>

- <span data-ttu-id="8ac59-238">忙線中的追蹤，找出您正在使用的 Office 365 服務。</span><span class="sxs-lookup"><span data-stu-id="8ac59-238">In a busy trace, locate the Office 365 service that you're using.</span></span> <span data-ttu-id="8ac59-239">如果您已經很少或永遠不會看到您之前的流量，這是與其他網路噪音分隔效能問題很有幫助步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-239">If you've never or seldom seen your traffic before, this is a helpful step in separating the performance issue from other network noise.</span></span> <span data-ttu-id="8ac59-240">有幾種方式可以這麼做。</span><span class="sxs-lookup"><span data-stu-id="8ac59-240">There are a few ways to do this.</span></span> <span data-ttu-id="8ac59-241">直接之前您的測試，您可以使用_ping_或_PsPing_針對特定服務的 URL (`ping outlook.office365.com`或`psping -4 microsoft-my.sharepoint.com:443`，例如)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-241">Directly before your test, you can use _ping_ or _PsPing_ against the URL of the specific service (`ping outlook.office365.com` or `psping -4 microsoft-my.sharepoint.com:443`, for example).</span></span> <span data-ttu-id="8ac59-242">您可以也輕鬆尋找該 ping 或 PsPing Netmon 追蹤 （其處理程序名稱）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-242">You can also easily find that ping or PsPing in a Netmon trace (by its process name).</span></span> <span data-ttu-id="8ac59-243">會將提供您理想的起點尋找。</span><span class="sxs-lookup"><span data-stu-id="8ac59-243">That will give you a place to start looking.</span></span>

<span data-ttu-id="8ac59-244">如果您只使用 Netmon 追蹤問題的時間，也沒關係太。</span><span class="sxs-lookup"><span data-stu-id="8ac59-244">If you're only using Netmon tracing at the time of the problem, that's okay too.</span></span> <span data-ttu-id="8ac59-245">若要引導您自己，使用類似的篩選器`ContainsBin(FrameData, ASCII, "office")`或`ContainsBin(FrameData, ASCII, "outlook")`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-245">To orient yourself, use a filter like `ContainsBin(FrameData, ASCII, "office")` or `ContainsBin(FrameData, ASCII, "outlook")`.</span></span> <span data-ttu-id="8ac59-246">您可以將記錄從追蹤檔案您圖文框的號碼。</span><span class="sxs-lookup"><span data-stu-id="8ac59-246">You can record your frame number from the trace file.</span></span> <span data-ttu-id="8ac59-247">您也可能會想要捲動到最右邊的_框架摘要_] 窗格，並尋找交談識別碼] 欄中的色彩。</span><span class="sxs-lookup"><span data-stu-id="8ac59-247">You may also want to scroll the _Frame Summary_ pane all the way to the right and look for the Conversation ID column.</span></span> <span data-ttu-id="8ac59-248">沒有為此特定對話視窗中，您也可以記錄，然後查看在稍後隔離的識別碼有指定的數字。</span><span class="sxs-lookup"><span data-stu-id="8ac59-248">There is a number indicated there for the ID of this specific conversation that you can also record and look at in isolation later.</span></span> <span data-ttu-id="8ac59-249">請記得在套用任何其他篩選之前先移除此篩選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-249">Remember to remove this filter before applying any other filtering.</span></span>

> [!TIP]
> <span data-ttu-id="8ac59-250">Netmon 有很有幫助的內建篩選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-250">Netmon has a lot of helpful built-in filters.</span></span> <span data-ttu-id="8ac59-251">請試著頂端的 [_顯示_篩選窗格的 [ **Load Filter** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="8ac59-251">Try the **Load Filter** button at the top of the _Display_ filter pane.</span></span>
  
![在命令列上的用戶端電腦使用 PSPing，以尋找您 IP。](media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)
  
![Netmon 追蹤從用戶端透過 TCP 的篩選器中顯示的相同 PSPing 命令。Flags.Syn = = 1。](media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)
  
<span data-ttu-id="8ac59-254">熟悉您的流量，並了解如何找到所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="8ac59-254">Get familiar with your traffic, and learn to locate the information you need.</span></span> <span data-ttu-id="8ac59-255">例如，了解如何判斷哪一個封包追蹤中的有您正在使用 （例如 「 Outlook 」) 的 Office 365 服務的第一個參照。</span><span class="sxs-lookup"><span data-stu-id="8ac59-255">For example, learn to determine which packet in the trace has the first reference to the Office 365 service you're using (like "Outlook").</span></span>

<span data-ttu-id="8ac59-256">取得 Office 365 Outlook Online 做為範例，流量開始可能類似如下：</span><span class="sxs-lookup"><span data-stu-id="8ac59-256">Taking Office 365 Outlook Online as an example, the traffic begins something like this:</span></span>
  
- <span data-ttu-id="8ac59-257">標準的 DNS 查詢和使用比對 QueryIDs outlook.office365.com 的 DNS 回應。</span><span class="sxs-lookup"><span data-stu-id="8ac59-257">DNS Standard Query and DNS Response for outlook.office365.com with matching QueryIDs.</span></span> <span data-ttu-id="8ac59-258">請務必注意這個開啟的因應措施，以及為 where 領域中 Office 365 全域 DNS 的時間位移傳送之要求的名稱解析。</span><span class="sxs-lookup"><span data-stu-id="8ac59-258">It's important to note the time offset for this turn-around, as well as where in the world the Office 365 Global DNS sends the request for name resolution.</span></span> <span data-ttu-id="8ac59-259">理想狀況下，為可行的而非跨越世界各地的如同在本機上。</span><span class="sxs-lookup"><span data-stu-id="8ac59-259">Ideally, as locally as possible, rather than halfway across the world.</span></span>

- <span data-ttu-id="8ac59-260">HTTP 取得要求的狀態報告已永久移動 (301)</span><span class="sxs-lookup"><span data-stu-id="8ac59-260">A HTTP GET Request whose status report Moved Permanently (301)</span></span>

- <span data-ttu-id="8ac59-261">RWS 流量包括 RWS 連線要求，以及連線回覆。</span><span class="sxs-lookup"><span data-stu-id="8ac59-261">RWS Traffic including RWS Connect requests and Connect replies.</span></span> <span data-ttu-id="8ac59-262">（這是供您進行連線的遠端 Winsock）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-262">(This is Remote Winsock making a connection for you.)</span></span>

- <span data-ttu-id="8ac59-263">TCP SYN-RCVD 和 TCP SYN-RCVD/ACK 交談。</span><span class="sxs-lookup"><span data-stu-id="8ac59-263">A TCP SYN and TCP SYN/ACK conversation.</span></span> <span data-ttu-id="8ac59-264">很多此交談中的設定會影響效能。</span><span class="sxs-lookup"><span data-stu-id="8ac59-264">A lot of the settings in this conversation impact your performance.</span></span>

- <span data-ttu-id="8ac59-265">接著一系列的 TLS:TLS 流量也就是 TLS 信號交換和 TLS 憑證交談採取適當的地方。</span><span class="sxs-lookup"><span data-stu-id="8ac59-265">Then a series of TLS:TLS traffic which is where the TLS handshake and TLS certificate conversations take place.</span></span> <span data-ttu-id="8ac59-266">（請記住會透過 SSL/TLS 加密的資料）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-266">(Remember the data is encrypted via SSL/TLS.)</span></span>

<span data-ttu-id="8ac59-267">所有的組件的流量重要與連線，但小型的某些部分的追蹤包含方面效能問題的疑難排解，尤其重要的資訊，因此我們將重點放在這些區域。</span><span class="sxs-lookup"><span data-stu-id="8ac59-267">All parts of the traffic are important and connected, but small portions of the trace contain information particularly important in terms of performance troubleshooting, so we'll focus on those areas.</span></span> <span data-ttu-id="8ac59-268">此外，因為我們已經完成不足，無法在 Microsoft，以編譯頂端十個清單的常見問題疑難排解的 Office 365 效能，我們將專注於這些問題以及如何使用的工具，我們有查明下一步]。</span><span class="sxs-lookup"><span data-stu-id="8ac59-268">Also, since we've done enough Office 365 performance troubleshooting at Microsoft to compile a Top Ten list of common problems, we'll focus on those issues and how to use the tools we have to root them out next.</span></span>
  
<span data-ttu-id="8ac59-269">如果您尚未安裝已經準備好，下列矩陣會讓使用數種工具。</span><span class="sxs-lookup"><span data-stu-id="8ac59-269">If you haven't installed them all ready, the matrix below makes use of several tools.</span></span> <span data-ttu-id="8ac59-270">請儘可能。</span><span class="sxs-lookup"><span data-stu-id="8ac59-270">Where possible.</span></span> <span data-ttu-id="8ac59-271">連結提供安裝點。</span><span class="sxs-lookup"><span data-stu-id="8ac59-271">Links are provided to the installation points.</span></span> <span data-ttu-id="8ac59-272">清單包含常見的網路追蹤工具，像是[Netmon](https://www.microsoft.com/en-us/download/details.aspx?id=4865)和[Wireshark](https://www.wireshark.org/)，但使用任何追蹤工具，您可以執行對象]，並在其中您正在習慣篩選網路流量。</span><span class="sxs-lookup"><span data-stu-id="8ac59-272">The list includes common network tracing tools like [Netmon](https://www.microsoft.com/en-us/download/details.aspx?id=4865) and [Wireshark](https://www.wireshark.org/), but use any tracing tool you are comfortable with, and in which you're accustomed to filtering network traffic.</span></span> <span data-ttu-id="8ac59-273">當您正在測試時，請記得：</span><span class="sxs-lookup"><span data-stu-id="8ac59-273">When you're testing, remember:</span></span>
  
- <span data-ttu-id="8ac59-274">*關閉您的瀏覽器，並測試只能有一個執行的瀏覽器搭配*-這會降低您所擷取的整體流量。</span><span class="sxs-lookup"><span data-stu-id="8ac59-274">*Close your browsers, and test with only one browser running*  - This will reduce the overall traffic you capture.</span></span> <span data-ttu-id="8ac59-275">它會針對較不忙碌中的追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-275">It makes for a less busy trace.</span></span>
- <span data-ttu-id="8ac59-276">*清除您的 DNS 解析程式快取的用戶端電腦上*-這可讓您從頭採取更簡潔的追蹤您擷取，啟動時。</span><span class="sxs-lookup"><span data-stu-id="8ac59-276">*Flush your DNS resolver cache on the client computer*  - This will give you a clean slate when you start to take your capture, for a cleaner trace.</span></span>

## <a name="common-issues"></a><span data-ttu-id="8ac59-277">常見問題</span><span class="sxs-lookup"><span data-stu-id="8ac59-277">Common issues</span></span>

<span data-ttu-id="8ac59-278">也可能會遇到一些常見的問題以及如何找到您的網路追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-278">Some common issues you may face and how to find them in your Network trace.</span></span>

### <a name="tcp-windows-scaling"></a><span data-ttu-id="8ac59-279">TCP 視窗縮放比例</span><span class="sxs-lookup"><span data-stu-id="8ac59-279">TCP Windows Scaling</span></span>

<span data-ttu-id="8ac59-280">位於 SYN-RCVD-SYN-RCVD/通知</span><span class="sxs-lookup"><span data-stu-id="8ac59-280">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="8ac59-281">舊版或過時的硬體不可能會利用 TCP 視窗縮放比例。</span><span class="sxs-lookup"><span data-stu-id="8ac59-281">Legacy or aging hardware may not take advantage of TCP windows scaling.</span></span>  <span data-ttu-id="8ac59-282">沒有適當的 TCP 視窗縮放比例設定，預設 16 位元緩衝區 TCP 標頭中的會填入以毫秒為單位。</span><span class="sxs-lookup"><span data-stu-id="8ac59-282">Without proper TCP windows scaling settings, the default 16-bit buffer in TCP headers fills in milliseconds.</span></span>  <span data-ttu-id="8ac59-283">流量不能繼續傳送直到用戶端收到認可，已收到的原始資料，而造成延遲。</span><span class="sxs-lookup"><span data-stu-id="8ac59-283">Traffic cannot continue to send until the client receives an acknowledgment that the original data has been received, causing delays.</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-284">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-284">Tools</span></span>

- <span data-ttu-id="8ac59-285">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-285">Netmon</span></span>
- <span data-ttu-id="8ac59-286">在 Wireshark</span><span class="sxs-lookup"><span data-stu-id="8ac59-286">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-287">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-287">What to look for</span></span>

<span data-ttu-id="8ac59-288">尋找 SYN-RCVD-SYN-RCVD/ACK 流量網路追蹤中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-288">Look for the SYN - SYN/ACK traffic in your network trace.</span></span>  <span data-ttu-id="8ac59-289">在 Netmon，使用類似的篩選器`tcp.flags.syn == 1`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-289">In Netmon, use a filter like  `tcp.flags.syn == 1`.</span></span> <span data-ttu-id="8ac59-290">此篩選器是 Wireshark 中相同。</span><span class="sxs-lookup"><span data-stu-id="8ac59-290">This filter is the same in Wireshark.</span></span>  

![在 Netmon 或 Wireshark 篩選 Syn-rcvd 封包的這兩種工具： TCP。Flags.Syn = = 1。](media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

<span data-ttu-id="8ac59-292">請注意，針對每個 SYN-RCVD 有來源 （來源） 的連接埠號碼符合目的地連接埠 (DstPort) 的相關通知 (SYN-RCVD/ACK) 中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-292">Notice that for every SYN there is a source port (SrcPort) number that is matched in the destination port (DstPort) of the related Acknowledgment (SYN/ACK).</span></span>

<span data-ttu-id="8ac59-293">若要檢視您的網路連線由 Windows 調整值，請依序展開 [第一次 SYN-RCVD，然後按一下 [相關的 SYN-RCVD/通知</span><span class="sxs-lookup"><span data-stu-id="8ac59-293">To see the Windows Scaling value that is used by your network connection, expand first the SYN, and then the related SYN/ACK.</span></span>  

![圖形，顯示如何符合與 DstPort 來源中的追蹤，以取得時間差異。](media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)  

### <a name="tcp-idle-time-settings"></a><span data-ttu-id="8ac59-295">TCP 閒置時間設定</span><span class="sxs-lookup"><span data-stu-id="8ac59-295">TCP Idle Time Settings</span></span>

<span data-ttu-id="8ac59-296">在過去，大部分的周邊網路設定暫時性的連線，這表示閒置連線通常會終止。</span><span class="sxs-lookup"><span data-stu-id="8ac59-296">Historically, most perimeter networks are configured for transient connections, meaning idle connections are generally terminated.</span></span> <span data-ttu-id="8ac59-297">閒置 TCP 工作階段可以藉由 proxy 和防火牆在大於 100 到 300 秒終止。</span><span class="sxs-lookup"><span data-stu-id="8ac59-297">Idle TCP sessions can be terminated by proxies and firewalls at greater than 100 to 300 seconds.</span></span> <span data-ttu-id="8ac59-298">這是問題，Outlook online 因為它會建立並使用長期的連線，無論或不是閒置。</span><span class="sxs-lookup"><span data-stu-id="8ac59-298">This is problematic for Outlook Online because it creates and uses long-term connections, whether they are idle or not.</span></span>  

<span data-ttu-id="8ac59-299">當連線會終止 proxy 或防火牆裝置，用戶端明智，並不嘗試使用 Outlook 線上將表示用戶端電腦會嘗試，便會重複替換，恢復從之前先製作一個新的連線。</span><span class="sxs-lookup"><span data-stu-id="8ac59-299">When connections are terminated by proxy or firewall devices, the client is not informed, and an attempt to use Outlook Online will mean a client computer will try, repeatedly, to revive the connection before making a new one.</span></span> <span data-ttu-id="8ac59-300">您可能會在載入頁面上看到擱置中的產品、 提示或效能降低。</span><span class="sxs-lookup"><span data-stu-id="8ac59-300">You may see hangs in the product, prompts, or slow performance on page load.</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-301">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-301">Tools</span></span>

- <span data-ttu-id="8ac59-302">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-302">Netmon</span></span>
- <span data-ttu-id="8ac59-303">在 Wireshark</span><span class="sxs-lookup"><span data-stu-id="8ac59-303">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-304">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-304">What to look for</span></span>

<span data-ttu-id="8ac59-305">在 Netmon，查看來回行程時間位移欄位。</span><span class="sxs-lookup"><span data-stu-id="8ac59-305">In Netmon, look at the Time Offset field for a round-trip.</span></span> <span data-ttu-id="8ac59-306">來回行程是將要求傳送至伺服器和接收回應回用戶端之間的時間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-306">A round-trip is the time between client sending a request to the server and receiving a response back.</span></span> <span data-ttu-id="8ac59-307">檢查用戶端與輸出點 （例如。</span><span class="sxs-lookup"><span data-stu-id="8ac59-307">Check between the Client and the egress point (ex.</span></span> <span data-ttu-id="8ac59-308">用戶端-\> Proxy)，或 Office 365 用戶端 (用戶端-\> Office 365)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-308">Client --\> Proxy), or the Client to Office 365 (Client --\> Office 365).</span></span> <span data-ttu-id="8ac59-309">您可以看到此許多封包的類型。</span><span class="sxs-lookup"><span data-stu-id="8ac59-309">You can see this in many types of packets.</span></span>

<span data-ttu-id="8ac59-310">例如，在 Netmon 中的篩選可能看起來像`.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`，或在 Wireshark， `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-310">As an example, the filter in Netmon may look like  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`, or, in Wireshark,  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.</span></span>  

> [!TIP]
> <span data-ttu-id="8ac59-311">不知道您追蹤中的 IP 位址是否屬於您的 DNS 伺服器？</span><span class="sxs-lookup"><span data-stu-id="8ac59-311">Don't know if the IP address in your trace belongs to your DNS server?</span></span> <span data-ttu-id="8ac59-312">請試著查閱在命令列。</span><span class="sxs-lookup"><span data-stu-id="8ac59-312">Try looking it up at the command line.</span></span> <span data-ttu-id="8ac59-313">按一下 [**開始** \> **執行**\>和輸入**cmd**，或按下**Windows 鍵** \> ，然後輸入**cmd**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-313">Click **Start** \> **Run** \> and type **cmd**, or press **Windows Key** \> and type **cmd**.</span></span> <span data-ttu-id="8ac59-314">在提示處輸入`nslookup <the IP address from the network trace>`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-314">At the prompt, type  `nslookup <the IP address from the network trace>`.</span></span> <span data-ttu-id="8ac59-315">若要測試，請使用 nslookup 針對您自己的電腦 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-315">To test, use nslookup against your own computer's IP address.</span></span> <span data-ttu-id="8ac59-316"><b0>Office 365 Url 和 IP 位址範圍</b0>，請參閱 < &gt; 以查看 Microsoft 的 IP 範圍的清單。</span><span class="sxs-lookup"><span data-stu-id="8ac59-316">> To see a list of Microsoft's IP ranges, see [Office 365 URLs and IP address ranges](https://technet.microsoft.com/en-us/library/hh373144.aspx).</span></span>

<span data-ttu-id="8ac59-317">問題時，預期長時間位移出現，在此情況下 (Outlook Online)，特別是在 TLS:TLS 封包所顯示的應用程式資料傳送過程中 (例如，在 Netmon 中您可以尋找應用程式資料封包透過`.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-317">If there is a problem, expect long Time Offsets to appear, in this case (Outlook Online), particularly in TLS:TLS packets that show the passage of Application Data (for example, in Netmon you can find application data packets via  `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`).</span></span> <span data-ttu-id="8ac59-318">您應該會看到的時間內順利進程整個工作階段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-318">You should see a smooth progression in the time across the session.</span></span> <span data-ttu-id="8ac59-319">如果重新整理您 Outlook 線上時，您會看到長時間延遲，這可能因重設傳送高程度。</span><span class="sxs-lookup"><span data-stu-id="8ac59-319">If you see long delays when refreshing your Outlook Online, this could be caused by a high degree of resets being sent.</span></span>

### <a name="latencyround-trip-time"></a><span data-ttu-id="8ac59-320">延遲/來回中斷時間</span><span class="sxs-lookup"><span data-stu-id="8ac59-320">Latency/Round Trip Time</span></span>

<span data-ttu-id="8ac59-321">延遲是可以變更根據許多變數，這類升級過時裝置，將大量的使用者新增至網路，以及上的網路連線的其他工作所耗用的整體頻寬百分比的花費量值。</span><span class="sxs-lookup"><span data-stu-id="8ac59-321">Latency is a measure that can change a lot depending on many variables, such upgrading aging devices, adding a large number of users to a network, and the percentage of overall bandwidth consumed by other tasks on a network connection.</span></span>

<span data-ttu-id="8ac59-322">有可用的 Office 365 的頻寬計算器從此[網路規劃和效能調整的 Office 365](network-planning-and-performance.md)頁面。</span><span class="sxs-lookup"><span data-stu-id="8ac59-322">There are bandwidth calculators for Office 365 available from this [Network planning and performance tuning for Office 365](network-planning-and-performance.md) page.</span></span>  

<span data-ttu-id="8ac59-323">測量的連線或您的 ISP 連線頻寬速度的需要嗎？</span><span class="sxs-lookup"><span data-stu-id="8ac59-323">Need to measure the speed of your connection, or your ISP connection's bandwidth?</span></span> <span data-ttu-id="8ac59-324">請嘗試此網站 （或類似的網站）： [Speedtest 官方網站](https://www.speedtest.net/)及[Pingtest](http://www.pingtest.net/)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-324">Try this site (or sites like it): [Speedtest Official Site](https://www.speedtest.net/), and [Pingtest](http://www.pingtest.net/).</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-325">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-325">Tools</span></span>

- <span data-ttu-id="8ac59-326">Ping</span><span class="sxs-lookup"><span data-stu-id="8ac59-326">Ping</span></span>
- <span data-ttu-id="8ac59-327">PsPing</span><span class="sxs-lookup"><span data-stu-id="8ac59-327">PsPing</span></span>
- <span data-ttu-id="8ac59-328">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-328">Netmon</span></span>
- <span data-ttu-id="8ac59-329">在 Wireshark</span><span class="sxs-lookup"><span data-stu-id="8ac59-329">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-330">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-330">What to look for</span></span>

<span data-ttu-id="8ac59-331">若要追蹤中追蹤的延遲，您獲益具有 Office 365 中記錄的用戶端電腦 IP 位址和 DNS 伺服器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-331">To track latency in a trace, you will benefit from having recorded the client computer IP address and the IP address of the DNS server in Office 365.</span></span> <span data-ttu-id="8ac59-332">這是目的更輕鬆地追蹤篩選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-332">This is for the purpose of easier trace filtering.</span></span> <span data-ttu-id="8ac59-333">如果您透過 proxy 連線，您會需要您用戶端電腦的 IP 位址、 proxy/輸出 IP 位址，以及 Office 365 DNS IP 位址，以方便的工作。</span><span class="sxs-lookup"><span data-stu-id="8ac59-333">If you connect through a proxy, you will need your client computer IP address, the proxy/egress IP address, and the Office 365 DNS IP address, to make the work easier.</span></span>  

<span data-ttu-id="8ac59-334">傳送給 outlook.office365.com 的 ping 要求會告訴您收到要求，資料中心的名稱即使 ping*可能*無法連線至連續 ICMP 封包傳送商標。</span><span class="sxs-lookup"><span data-stu-id="8ac59-334">A ping request sent to outlook.office365.com will tell you the name of the datacenter receiving the request, even if ping  *may*  not be able to connect to send the trademark consecutive ICMP packets.</span></span> <span data-ttu-id="8ac59-335">如果您使用特定連接埠 (443) 和 PsPing （下載的免費工具），而且可能是使用 IPv4 (-4) 就會平均 round 來回時間傳送封包。</span><span class="sxs-lookup"><span data-stu-id="8ac59-335">If you use PsPing (a free tool for download), and specific the port (443) and perhaps to use IPv4 (-4) you will get an average round-trip-time for packets sent.</span></span> <span data-ttu-id="8ac59-336">這會適合此 Office 365 服務中，其他 Url like `psping -4 yourSite.sharepoint.com:443`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-336">This will work this for other URLs in the Office 365 services, like `psping -4 yourSite.sharepoint.com:443`.</span></span> <span data-ttu-id="8ac59-337">事實上，您可以指定的數目較大的範例為取得您平均的嘗試類似的 ping `psping -4 -n 20 yourSite-my.sharepoint.com:443`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-337">In fact, you can specify a number of pings to get a larger sample for your average, try something like `psping -4 -n 20 yourSite-my.sharepoint.com:443`.</span></span>  

> [!NOTE]
> <span data-ttu-id="8ac59-338">PsPing 不會傳送 ICMP 封包。</span><span class="sxs-lookup"><span data-stu-id="8ac59-338">PsPing doesn't send ICMP packets.</span></span> <span data-ttu-id="8ac59-339">它會偵測與 TCP 封包透過特定連接埠，所以您可以使用您知道要開啟任何一個。</span><span class="sxs-lookup"><span data-stu-id="8ac59-339">It pings with TCP packets over a specific port, so you can use any one you know to be open.</span></span> <span data-ttu-id="8ac59-340">在 Office 365 中，它會使用 SSL/TLS，請嘗試附加連接埠： 443 以您 PsPing。</span><span class="sxs-lookup"><span data-stu-id="8ac59-340">In Office 365, which uses SSL/TLS, try attaching port :443 to your PsPing.</span></span>

![螢幕擷取畫面顯示 ping 與進行相同，但回報 6.5 m s 平均 RTT 443 解析 outlook.office365.com，與 PSPing。](media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

<span data-ttu-id="8ac59-342">如果您進行網路追蹤時載入緩慢執行的 Office 365] 頁面上，您應該篩選的 Netmon 或 Wireshark 追蹤`DNS`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-342">If you loaded the slow performing Office 365 page while doing a network trace, you should filter a Netmon or Wireshark trace for `DNS`.</span></span> <span data-ttu-id="8ac59-343">這是下列其中一個我們要尋找 Ip。</span><span class="sxs-lookup"><span data-stu-id="8ac59-343">This is one of the IPs we're looking for.</span></span>  

<span data-ttu-id="8ac59-344">以下是以篩選要取得的 IP 位址 （和看看 DNS 延遲） 您 Netmon 所採取的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-344">Here are the steps to take to filter your Netmon to get the IP address (and take a look at DNS Latency).</span></span> <span data-ttu-id="8ac59-345">此範例使用 outlook.office365.com，但也可以使用 SharePoint Online 租用戶 (例如 hithere.sharepoint.com) 的 URL。</span><span class="sxs-lookup"><span data-stu-id="8ac59-345">This example uses outlook.office365.com, but may also use the URL of a SharePoint Online tenant (hithere.sharepoint.com for example).</span></span>  

1. <span data-ttu-id="8ac59-346">Ping URL`ping outlook.office365.com`並在結果中，記錄的名稱和 ping 要求傳送至 DNS 伺服器 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-346">Ping the URL `ping outlook.office365.com` and, in the results, record the name and IP address of the DNS server the ping request was sent to.</span></span>
2. <span data-ttu-id="8ac59-347">網路追蹤開啟頁面，或執行巨集指令，可讓您的效能問題，或如果您看到 ping，本身，高延遲網路追蹤它。</span><span class="sxs-lookup"><span data-stu-id="8ac59-347">Network trace opening the page, or doing the action that gives you the performance problem, or, if you see a high latency on the ping, itself, network trace it.</span></span>
3. <span data-ttu-id="8ac59-348">開啟 DNS 中 Netmon 及篩選追蹤 (此篩選器也在 Wireshark 中, 運作，但寫`-- dns`)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-348">Open the trace in Netmon and filter for DNS (this filter also works in Wireshark, but is sensitive to case `-- dns`).</span></span> <span data-ttu-id="8ac59-349">既然您知道 DNS 伺服器的名稱，從您的 ping 您可能也會篩選像這樣的多個能快速在 Netmon:`DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`像這樣的 Wireshark dns 中，圖文框包含"namnorthwest"。</span><span class="sxs-lookup"><span data-stu-id="8ac59-349">Since you know the name of the DNS server from your ping you may also filter more speedily in Netmon like this: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`, which looks like this in Wireshark dns and frame contains "namnorthwest".</span></span><br/><span data-ttu-id="8ac59-350">開啟回應封包，並在 Netmon**圖文框詳細資料**] 視窗中，按一下 [ **DNS** ]，以展開 [如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="8ac59-350">Open the response packet and, in the Netmon **Frame Details** window, click **DNS** to expand for more information.</span></span> <span data-ttu-id="8ac59-351">在 [DNS 資訊您可以找到要求皆以在 Office 365 的 DNS 伺服器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-351">In the DNS information you'll find the IP address of the DNS server the request went to in Office 365.</span></span> <span data-ttu-id="8ac59-352">您將需要這個 IP 位址的下一個步驟 （PsPing 工具）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-352">You'll need this IP address for the next step (the PsPing tool).</span></span> <span data-ttu-id="8ac59-353">移除篩選，以滑鼠右鍵按一下 Netmon 中的 DNS 回應 (**框架摘要** \> **尋找交談** \> **DNS**) 若要查看 DNS 查詢和回應-並存。</span><span class="sxs-lookup"><span data-stu-id="8ac59-353">Remove the filter, right-click on the DNS Response in Netmon (**Frame Summary** \> **Find Conversations** \> **DNS**) to see the DNS Query and Response side-by-side.</span></span>
4. <span data-ttu-id="8ac59-354">在 Netmon，也請注意 [時間位移] 欄中的 DNS 要求和回應之間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-354">In Netmon, also note the Time Offset  column between the DNS Request and Response.</span></span> <span data-ttu-id="8ac59-355">在下一個步驟、 易於安裝和使用[PsPing](https://technet.microsoft.com/en-us/sysinternals/jj729731.aspx)工具更為非常實用，同時由於 ICMP 通常會封鎖在防火牆，而且 PsPing 精細追蹤延遲 （毫秒）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-355">In the next step, the easy-to-install and use [PsPing](https://technet.microsoft.com/en-us/sysinternals/jj729731.aspx) tool comes in very handy, both because ICMP is often blocked on Firewalls, and because PsPing elegantly tracks latency in milliseconds.</span></span> <span data-ttu-id="8ac59-356">PsPing 完成 TCP 連線到地址和連接埠 （在我們案例開啟連接埠 443）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-356">PsPing completes a TCP connection to an address and port (in our case open port 443).</span></span>
5. <span data-ttu-id="8ac59-357">安裝 PsPing。</span><span class="sxs-lookup"><span data-stu-id="8ac59-357">Install PsPing.</span></span>
6. <span data-ttu-id="8ac59-358">開啟命令提示字元 (啟動\>執行\>輸入 cmd 或 Windows 鍵\>輸入 cmd)，將目錄變更至 PsPing 執行 PsPing 命令的安裝所在的目錄。</span><span class="sxs-lookup"><span data-stu-id="8ac59-358">Open a command prompt (Start \> Run \> type cmd, or Windows Key \> type cmd) and change directory to the directory where you installed PsPing to run the PsPing command.</span></span> <span data-ttu-id="8ac59-359">在 [我的範例中您可以看到我所進行的 c 根目錄 'Qfe' 資料夾您可以執行相同的快速存取。</span><span class="sxs-lookup"><span data-stu-id="8ac59-359">In my examples you can see I made a 'Perf' folder on the root of C. You can do the same for quick access.</span></span>
7. <span data-ttu-id="8ac59-360">類型命令，讓您在先前 Netmon 追蹤，包括連接埠號碼，對您針對 Office 365 DNS 伺服器的 IP 位址 PsPing like `psping -n 20 132.245.24.82:445`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-360">Type the command so that you're making your PsPing against the IP address of the Office 365 DNS server from your earlier Netmon trace, including the port number, like `psping -n 20 132.245.24.82:445`.</span></span> <span data-ttu-id="8ac59-361">這會為您提供的 20 ping 取樣，而且當 PsPing 停駐點的平均延遲。</span><span class="sxs-lookup"><span data-stu-id="8ac59-361">This will give you a sampling of 20 pings and average the latency when PsPing stops.</span></span>

<span data-ttu-id="8ac59-362">如果您正在透過 proxy 伺服器移至 Office 365，是略有不同的步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-362">If you're going to Office 365 through a proxy server, the steps are a little different.</span></span> <span data-ttu-id="8ac59-363">以您的 proxy 伺服器，以取得平均延遲值以毫秒為單位 proxy/輸出和上一步]，將第一個 PsPing，然後 [執行 PsPing proxy，或電腦上有直接的網際網路連線，以取得缺少的值 （一個 Office 365 和上一步）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-363">You would first PsPing to your proxy server to get an average latency value in milliseconds to proxy/egress and back, and then either run PsPing on the proxy, or on a computer with a direct Internet connection to get the missing value (the one to Office 365 and back).</span></span>  

<span data-ttu-id="8ac59-364">如果您選擇執行 proxy PsPing，您將有兩個毫秒值： proxy 伺服器或輸出點及 proxy 伺服器到 Office 365 用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="8ac59-364">If you choose to run PsPing from the proxy, you'll have two millisecond values: Client computer to proxy server or egress point, and proxy server to Office 365.</span></span> <span data-ttu-id="8ac59-365">和大功告成 ！</span><span class="sxs-lookup"><span data-stu-id="8ac59-365">And you're done!</span></span> <span data-ttu-id="8ac59-366">嗯，還是錄製值。</span><span class="sxs-lookup"><span data-stu-id="8ac59-366">Well, recording values, anyway.</span></span>  

<span data-ttu-id="8ac59-367">如果您在另一個具有直接連線至網際網路的用戶端電腦上執行 PsPing，也就是 proxy，而您會有兩個毫秒值： proxy 伺服器或輸出點，與 Office 365 用戶端電腦的用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="8ac59-367">If you run PsPing on another client computer that has a direct connection to the Internet, that is, without a proxy, you will have two millisecond values: Client computer to proxy server or egress point, and client computer to Office 365.</span></span> <span data-ttu-id="8ac59-368">在此情況下，proxy 伺服器或輸出點到 Office 365 用戶端電腦的值減去用戶端電腦的值必須 RTT 數字從您的用戶端電腦將 proxy 伺服器或輸出點，並從 [proxy 伺服器或輸出指向 Office 365。</span><span class="sxs-lookup"><span data-stu-id="8ac59-368">In this case, subtract the value of client computer to proxy server or egress point from the value of client computer to Office 365, and you will have the RTT numbers from your client computer to the proxy server or egress point, and from proxy server or egress point to Office 365.</span></span>

<span data-ttu-id="8ac59-369">不過，如果您可以在受影響的位置，直接連線，或略過 proxy 找到的用戶端電腦，您可能會選擇查看是否問題重現那里一開始先和測試之後使用。</span><span class="sxs-lookup"><span data-stu-id="8ac59-369">However, if you can find a client computer in the impacted location that is directly connected, or bypasses the proxy, you may choose to see if the issue reproduces there to begin with, and test using it thereafter.</span></span>

<span data-ttu-id="8ac59-370">延遲，視為 Netmon 追蹤，這些額外的毫秒可以加總，如果有足夠的它們在任何指定的工作階段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-370">Latency, as seen in a Netmon trace, those extra milliseconds can add up, if there are enough of them in any given session.</span></span>  

![Netmon 中的一般延遲，並將 Netmon 預設時間差異欄位新增至框架摘要。](media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> <span data-ttu-id="8ac59-372">您的 IP 位址可能會不同於 IPs 如下所示，例如，您 ping 可能會傳回類似詳細 157.56.0.0/16 或類似的範圍。</span><span class="sxs-lookup"><span data-stu-id="8ac59-372">Your IP address may be different than the IPs shown here, for example, your ping may return something more like 157.56.0.0/16 or a similar range.</span></span> <span data-ttu-id="8ac59-373">如需 Office 365 所使用的範圍的清單，請參閱[Office 365 Url 和 IP 位址範圍](https://technet.microsoft.com/en-us/library/hh373144.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-373">For a list of ranges used by Office 365, check out [Office 365 URLs and IP address ranges](https://technet.microsoft.com/en-us/library/hh373144.aspx).</span></span>

<span data-ttu-id="8ac59-374">如果您想要搜尋，例如 132.245，請記得要展開 （在此頂端沒有] 按鈕） 的所有節點。</span><span class="sxs-lookup"><span data-stu-id="8ac59-374">Remember to expand all the nodes (there's a button at the top for this) if you want to search for, for example, 132.245.</span></span>

### <a name="proxy-authentication"></a><span data-ttu-id="8ac59-375">Proxy 驗證</span><span class="sxs-lookup"><span data-stu-id="8ac59-375">Proxy Authentication</span></span>

<span data-ttu-id="8ac59-376">這僅適用於您如果要透過 proxy 伺服器。</span><span class="sxs-lookup"><span data-stu-id="8ac59-376">This only applies to you if you're going through a proxy server.</span></span> <span data-ttu-id="8ac59-377">如果不是，您可以略過這些步驟。</span><span class="sxs-lookup"><span data-stu-id="8ac59-377">If not, you can skip these steps.</span></span> <span data-ttu-id="8ac59-378">運作正常，proxy 驗證應該會發生以毫秒為單位，一致。</span><span class="sxs-lookup"><span data-stu-id="8ac59-378">When working properly, proxy authentication should take place in milliseconds, consistently.</span></span> <span data-ttu-id="8ac59-379">您不應該 （例如） 請參閱間歇性效能不佳尖峰使用量時段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-379">You shouldn't see intermittent bad performance during peak usage periods (for example).</span></span>  

<span data-ttu-id="8ac59-380">如果 Proxy 驗證，每當您對 Office 365 以取得資訊進行新的 TCP 連線，您需要通過驗證程序在幕後。</span><span class="sxs-lookup"><span data-stu-id="8ac59-380">If Proxy authentication is on, each time you make a new TCP connection to Office 365 to get information, you need to pass through an authentication process behind the scenes.</span></span> <span data-ttu-id="8ac59-381">因此，例如時從行事曆切換到 Outlook Online 中的郵件，您會進行驗證。</span><span class="sxs-lookup"><span data-stu-id="8ac59-381">So, for example, when switching from Calendar to Mail in Outlook Online, you will authenticate.</span></span> <span data-ttu-id="8ac59-382">和在 SharePoint Online 中，如果] 頁面上顯示媒體或資料從多個網站] 或 [位置] 中，您會驗證的每個不同的 TCP 連線所需才能轉譯資料。</span><span class="sxs-lookup"><span data-stu-id="8ac59-382">And in SharePoint Online, if a page displays media or data from multiple sites or locations, you will authenticate for each different TCP connection that is needed in order to render the data.</span></span>  

<span data-ttu-id="8ac59-383">在 Outlook Online 中，您可能會遇到緩慢的載入時間每當您切換行事曆與您的信箱，或 SharePoint Online 中載入速度很慢的頁面。</span><span class="sxs-lookup"><span data-stu-id="8ac59-383">In Outlook Online, you may experience slow load times whenever you switch between Calendar and your mailbox, or slow page loads in SharePoint Online.</span></span> <span data-ttu-id="8ac59-384">不過，還有其他此處未列出的徵狀。</span><span class="sxs-lookup"><span data-stu-id="8ac59-384">However, there are other symptoms not listed here.</span></span>

<span data-ttu-id="8ac59-385">Proxy 驗證是在您的輸出 proxy 伺服器上的設定。</span><span class="sxs-lookup"><span data-stu-id="8ac59-385">Proxy authentication is a setting on your egress proxy server.</span></span> <span data-ttu-id="8ac59-386">如果它與 Office 365 造成的效能問題，您必須請洽詢您網路的小組。</span><span class="sxs-lookup"><span data-stu-id="8ac59-386">If it is causing a performance issue with Office 365, you must consult your networking team.</span></span>  

#### <a name="tools"></a><span data-ttu-id="8ac59-387">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-387">Tools</span></span>

- <span data-ttu-id="8ac59-388">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-388">Netmon</span></span>
- <span data-ttu-id="8ac59-389">在 Wireshark</span><span class="sxs-lookup"><span data-stu-id="8ac59-389">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-390">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-390">What to look for</span></span>

<span data-ttu-id="8ac59-391">Proxy 驗證發生於每當必須向上，開始新的 TCP 工作階段，通常為檔案或資訊從伺服器要求，或提供資訊。</span><span class="sxs-lookup"><span data-stu-id="8ac59-391">Proxy authentication takes place whenever a new TCP session must be spun up, commonly to request files or info from the server, or to supply info.</span></span> <span data-ttu-id="8ac59-392">例如，您可能會看到周圍 HTTP GET 或 HTTP POST 要求的 proxy 驗證。</span><span class="sxs-lookup"><span data-stu-id="8ac59-392">For example, you may see proxy authentication around HTTP GET or HTTP POST requests.</span></span> <span data-ttu-id="8ac59-393">如果您想要查看您其中的驗證要求您追蹤中的框架，' NTLMSSP 摘要 ' 資料行新增至 Netmon 及篩選的`.property.NTLMSSPSummary`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-393">If you want to see the frames where you are authenticating requests in your trace, add the 'NTLMSSP Summary' column to Netmon and filter for  `.property.NTLMSSPSummary`.</span></span> <span data-ttu-id="8ac59-394">若要查看驗證正在多久，新增時間差異欄位。</span><span class="sxs-lookup"><span data-stu-id="8ac59-394">To see how long the authentication is taking, add the Time Delta column.</span></span>

<span data-ttu-id="8ac59-395">若要將欄新增至 Netmon:</span><span class="sxs-lookup"><span data-stu-id="8ac59-395">To add a column to Netmon:</span></span>

1. <span data-ttu-id="8ac59-396">例如： **Description**欄上按一下滑鼠右鍵。</span><span class="sxs-lookup"><span data-stu-id="8ac59-396">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="8ac59-397">按一下 [**選擇資料行**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-397">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="8ac59-398">在清單中找出_NTLMSSP 摘要_和_時間差異_，然後按一下 [**新增]**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-398">Locate _NTLMSSP Summary_ and _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="8ac59-399">進入新的資料行的位置之前的前面或後面 [_描述_] 欄讓您可以閱讀它們並排顯示。</span><span class="sxs-lookup"><span data-stu-id="8ac59-399">Move the new columns into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="8ac59-400">按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8ac59-400">Click **OK**.</span></span>

<span data-ttu-id="8ac59-401">即使您不新增資料行，將運作 Netmon 篩選器。</span><span class="sxs-lookup"><span data-stu-id="8ac59-401">Even if you don't add the column, the Netmon filter will work.</span></span> <span data-ttu-id="8ac59-402">但您疑難排解更加容易，如果您可以看到您在哪個階段的驗證。</span><span class="sxs-lookup"><span data-stu-id="8ac59-402">But your troubleshooting will be much easier if you can see what stage of authentication you're in.</span></span>

<span data-ttu-id="8ac59-403">要尋找的執行個體的 Proxy 驗證，務必是 NTLM 的挑戰，或驗證訊息的研究所有的圖文框時出現。</span><span class="sxs-lookup"><span data-stu-id="8ac59-403">When looking for instances of Proxy Authentication, be sure to study all frames where there is an NTLM Challenge, or an Authenticate Message is present.</span></span> <span data-ttu-id="8ac59-404">如有必要，以滑鼠右鍵按一下某一種流量和尋找交談\>TCP。</span><span class="sxs-lookup"><span data-stu-id="8ac59-404">If necessary, right-click the specific piece of traffic and Find Conversations \> TCP.</span></span> <span data-ttu-id="8ac59-405">請注意這些交談中的時間差異值。</span><span class="sxs-lookup"><span data-stu-id="8ac59-405">Be aware of the Time Delta values in these Conversations.</span></span>

![Netmon 追蹤顯示 proxy 驗證，由交談篩選。](media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

<span data-ttu-id="8ac59-407">在 proxy 驗證的 4 秒延遲，如 Wireshark 中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-407">A four second delay in proxy authentication as seen in Wireshark.</span></span> <span data-ttu-id="8ac59-408">**從上一個顯示的圖文框的時間差異**欄位進行透過以滑鼠右鍵按一下圖文框詳細資料中的相同名稱的欄位和做為資料行中選取 [新增。</span><span class="sxs-lookup"><span data-stu-id="8ac59-408">The **Time delta from previous displayed frame** column was made via right-clicking the field of the same name in the frame details and selecting Add as Column.</span></span>  <br/> <span data-ttu-id="8ac59-409">![Wireshark 中, 您可以透過以滑鼠右鍵按一下圖文框詳細資料中的相同名稱的欄位和做為資料行中選取 [新增進行 '從上一個顯示的圖文框的時間差異' 欄。](media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span><span class="sxs-lookup"><span data-stu-id="8ac59-409">![In Wireshark, the 'Time delta from previous displayed frame' column can be made via right-clicking the field of the same name in the frame details and selecting Add as Column.](media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span></span>

### <a name="dns-performance"></a><span data-ttu-id="8ac59-410">DNS 的效能</span><span class="sxs-lookup"><span data-stu-id="8ac59-410">DNS Performance</span></span>

<span data-ttu-id="8ac59-411">名稱解析 works 最佳和最快速時所花費的地方最用戶端的國家/地區盡可能接近。</span><span class="sxs-lookup"><span data-stu-id="8ac59-411">Name resolution works best and most quickly when it takes place as close to the client's country as possible.</span></span>

<span data-ttu-id="8ac59-412">如果 DNS 名稱解析正在進行載運到海外，它可以新增頁面載入秒數。</span><span class="sxs-lookup"><span data-stu-id="8ac59-412">If DNS name resolution is taking place overseas, it can add seconds to page loads.</span></span> <span data-ttu-id="8ac59-413">理想狀況下，名稱解析會發生在小於 100 毫秒。</span><span class="sxs-lookup"><span data-stu-id="8ac59-413">Ideally, name resolution happens in under 100ms.</span></span> <span data-ttu-id="8ac59-414">如果不是，您應該進行進一步調查。</span><span class="sxs-lookup"><span data-stu-id="8ac59-414">If not, you should do further investigation.</span></span>

> [!TIP]
> <span data-ttu-id="8ac59-415">不確定用戶端連線能力在 Office 365 中的運作方式？</span><span class="sxs-lookup"><span data-stu-id="8ac59-415">Not sure how Client Connectivity works in Office 365?</span></span> <span data-ttu-id="8ac59-416">看看的用戶端連線能力參考文件[在這裡](https://technet.microsoft.com/en-us/library/dn741250.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-416">Take a look at the Client Connectivity Reference document [here](https://technet.microsoft.com/en-us/library/dn741250.aspx).</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-417">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-417">Tools</span></span>

- <span data-ttu-id="8ac59-418">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-418">Netmon</span></span>
- <span data-ttu-id="8ac59-419">在 Wireshark</span><span class="sxs-lookup"><span data-stu-id="8ac59-419">Wireshark</span></span>
- <span data-ttu-id="8ac59-420">PsPing</span><span class="sxs-lookup"><span data-stu-id="8ac59-420">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-421">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-421">What to look for</span></span>

<span data-ttu-id="8ac59-422">分析 DNS 的效能是通常是另一項工作的網路追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-422">Analyzing DNS performance is typically another job for a network trace.</span></span> <span data-ttu-id="8ac59-423">不過，PsPing 也是統治，回或取出、 可能的原因很有幫助。</span><span class="sxs-lookup"><span data-stu-id="8ac59-423">However, PsPing is also helpful in ruling in, or out, a possible cause.</span></span>

<span data-ttu-id="8ac59-424">DNS 流量根據 TCP 及 UDP 要求和回應清楚標示出使用識別碼，以符合其特定回應的特定要求協助。</span><span class="sxs-lookup"><span data-stu-id="8ac59-424">DNS traffic is based on TCP and UDP requests and responses are clearly marked with an ID that will help to match a specific request with its specific response.</span></span> <span data-ttu-id="8ac59-425">您會看到 DNS 流量，例如，SharePoint Online 使用時的網路名稱或 URL 在網頁上。</span><span class="sxs-lookup"><span data-stu-id="8ac59-425">You'll see DNS traffic when, for example, SharePoint Online uses a network name or URL on a web page.</span></span> <span data-ttu-id="8ac59-426">為法則，大部分的此流量，除了當轉接區域，執行透過 UDP。</span><span class="sxs-lookup"><span data-stu-id="8ac59-426">As a rule of thumb, most of this traffic, except when transferring Zones, runs over UDP.</span></span>

<span data-ttu-id="8ac59-427">在 Netmon 和 Wireshark 中，將可讓您查看 DNS 流量的最基本篩選只是`dns`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-427">In both Netmon and Wireshark, the most basic filter that will let you look at DNS traffic is simply `dns`.</span></span> <span data-ttu-id="8ac59-428">請務必指定篩選條件時，使用小寫。</span><span class="sxs-lookup"><span data-stu-id="8ac59-428">Be sure to use lower case when specifying the filter.</span></span> <span data-ttu-id="8ac59-429">清除您的 DNS 解析程式快取，以重現問題，您的用戶端電腦上所顯示的之前，請記得。</span><span class="sxs-lookup"><span data-stu-id="8ac59-429">Remember to flush your DNS resolver cache before you begin to reproduce the issue on your client computer.</span></span> <span data-ttu-id="8ac59-430">例如，如果您有 [首頁] 頁面上的速度很慢 SharePoint Online 頁面載入時，您應該關閉所有瀏覽器、 開啟新的瀏覽器、 啟動追蹤、 清除您的 DNS 解析程式快取，以及瀏覽至您的 SharePoint Online 網站。</span><span class="sxs-lookup"><span data-stu-id="8ac59-430">For example, if you have a slow SharePoint Online page load for the Home page, you should close all browsers, open a new browser, start tracing, flush your DNS resolver cache, and browse to your SharePoint Online site.</span></span> <span data-ttu-id="8ac59-431">一旦整頁解析後，您應該停止，並儲存追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-431">Once the entire page resolves, you should stop and save the trace.</span></span>

![在 Netmon 中，DNS 的基本篩選器是 DNS。](media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

<span data-ttu-id="8ac59-433">您想要查看以下位移的時間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-433">You want to look at the time offset here.</span></span> <span data-ttu-id="8ac59-434">並可能很有幫助將**時間差異**欄位新增至 Netmon 您可以藉由完成下列步驟執行：</span><span class="sxs-lookup"><span data-stu-id="8ac59-434">And it may be helpful to add the **Time Delta** column to Netmon which you can do by completing these steps:</span></span>

1. <span data-ttu-id="8ac59-435">例如： **Description**欄上按一下滑鼠右鍵。</span><span class="sxs-lookup"><span data-stu-id="8ac59-435">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="8ac59-436">按一下 [**選擇資料行**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-436">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="8ac59-437">在清單中找出_時間差異_，然後按一下 [**新增]**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-437">Locate _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="8ac59-438">進入新欄位置之前的前面或後面 [_描述_] 欄，也可以閱讀並排顯示。</span><span class="sxs-lookup"><span data-stu-id="8ac59-438">Move the new column into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="8ac59-439">按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8ac59-439">Click **OK**.</span></span>

<span data-ttu-id="8ac59-440">如果您發現感興趣的查詢，請考慮隔離以滑鼠右鍵按一下該查詢的圖文框的詳細資訊] 面板中，選擇 [**尋找交談** \> **DNS**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-440">If you find a query of interest, consider isolating it by right-clicking that query in the frame details panel, choosing **Find Conversations** \> **DNS**.</span></span> <span data-ttu-id="8ac59-441">請注意網路交談面板跳轉 UDP 流量的特定對話其記錄檔中的權限。</span><span class="sxs-lookup"><span data-stu-id="8ac59-441">Notice that the Network Conversations panel jumps right to the specific conversation in its log of UDP traffic.</span></span>

![由 DNS、 篩選和使用尋找交談然後 DNS 來縮小結果的 Outlook 線上負載 Netmon 追蹤。](media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

<span data-ttu-id="8ac59-443">在 Wireshark 中您可以讓欄 DNS 時間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-443">In Wireshark you can make a column for DNS time.</span></span> <span data-ttu-id="8ac59-444">需要您追蹤 （或開啟追蹤） 中 Wireshark 及 filter by `dns`，或更多好心`dns.time`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-444">Take your trace (or open a trace) in Wireshark and filter by `dns`, or, more helpfully,  `dns.time`.</span></span> <span data-ttu-id="8ac59-445">按一下任何 DNS 查詢，並在面板中顯示的詳細資訊，請依序展開 [`Domain Name System (response)`詳細資料。</span><span class="sxs-lookup"><span data-stu-id="8ac59-445">Click on any DNS query, and, in the panel showing details, expand the  `Domain Name System (response)` details.</span></span> <span data-ttu-id="8ac59-446">您會看到一個欄位的時間 (例如， `[Time: 0.001111100 seconds]`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-446">You'll see a field for time (for example, `[Time: 0.001111100 seconds]`.</span></span> <span data-ttu-id="8ac59-447">這段時間上按一下滑鼠右鍵，然後選取 [**套用] 做為資料行**。</span><span class="sxs-lookup"><span data-stu-id="8ac59-447">Right-click this time and select **Apply as Column**.</span></span> <span data-ttu-id="8ac59-448">這會讓您**時間**資料行您追蹤的速度較快排序。</span><span class="sxs-lookup"><span data-stu-id="8ac59-448">This will give you a **Time** column for quicker sorting of your trace.</span></span> <span data-ttu-id="8ac59-449">若要排序依遞減值以查看其 DNS 呼叫新資料行上的按一下 [時間最長解決。</span><span class="sxs-lookup"><span data-stu-id="8ac59-449">Click on the new column to sort by descending values to see which DNS call took the longest to resolve.</span></span>

[<span data-ttu-id="8ac59-450">在 Wireshark 中由 (小寫) dns.time 篩選的 SharePoint Online 瀏覽，時間起點為將詳細資料納入欄位和遞增排序起。</span><span class="sxs-lookup"><span data-stu-id="8ac59-450">A browse of SharePoint Online filtered in Wireshark by (lowercase) dns.time, with the time from the details made into a column and sorted ascending.</span></span>](media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

<span data-ttu-id="8ac59-451">如果您想要執行的 DNS 解析時間更多調查，請嘗試針對使用 TCP 的 DNS 連接埠的 PsPing (例如， `psping <IP address of DNS server>:53`)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-451">If you would like to do more investigation of the DNS resolution time, try a PsPing against the DNS port used by TCP (for example,  `psping <IP address of DNS server>:53`) .</span></span> <span data-ttu-id="8ac59-452">您仍看到的效能問題？</span><span class="sxs-lookup"><span data-stu-id="8ac59-452">Do you still see a performance issue?</span></span> <span data-ttu-id="8ac59-453">如果您這麼做，問題是特定的很可能是特定的更廣泛的網路發出問題比您又打如何解析的 DNS 應用程式。</span><span class="sxs-lookup"><span data-stu-id="8ac59-453">If you do, then the problem is more likely to be a broader network issue than an issue of specific the DNS application you're hitting to do resolution.</span></span> <span data-ttu-id="8ac59-454">也值得一提，同樣地，，以 outlook.office365.com 的 ping 會告訴您其中的 Outlook 線上的 DNS 名稱解析正在進行中 (例如，namnorthwest.office365.com outlook)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-454">It's also worth mentioning, again, that a ping to outlook.office365.com will tell you where DNS name resolution for Outlook Online is taking place (for example, outlook-namnorthwest.office365.com).</span></span>

<span data-ttu-id="8ac59-455">如果此問題： 看起來要特定的 DNS，它可能需要連絡您的 IT 部門，以查看 DNS 組態和 DNS 轉寄站進一步調查此問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-455">If the issue looks to be DNS specific, it may be necessary to contact your IT department to look at DNS configurations and DNS Forwarders to further investigate this issue.</span></span>

### <a name="proxy-scalability"></a><span data-ttu-id="8ac59-456">Proxy 延展性</span><span class="sxs-lookup"><span data-stu-id="8ac59-456">Proxy Scalability</span></span>

<span data-ttu-id="8ac59-457">Office 365 Outlook Online 等服務授與用戶端長期的多個連接。</span><span class="sxs-lookup"><span data-stu-id="8ac59-457">Services like Outlook Online in Office 365 grant clients multiple long-term connections.</span></span> <span data-ttu-id="8ac59-458">因此，每位使用者可能使用多個需要較長的生命週期的連線。</span><span class="sxs-lookup"><span data-stu-id="8ac59-458">Therefore, each user may use more connections that require a longer life.</span></span>  

#### <a name="tools"></a><span data-ttu-id="8ac59-459">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-459">Tools</span></span>

<span data-ttu-id="8ac59-460">數學</span><span class="sxs-lookup"><span data-stu-id="8ac59-460">Math</span></span>  

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-461">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-461">What to look for</span></span>

<span data-ttu-id="8ac59-462">沒有網路追蹤或疑難排解工具專屬於這。</span><span class="sxs-lookup"><span data-stu-id="8ac59-462">There is no network trace or troubleshooting tool specific to this.</span></span> <span data-ttu-id="8ac59-463">相反地，它會根據指定限制和其他變數的頻寬計算。</span><span class="sxs-lookup"><span data-stu-id="8ac59-463">Instead, it's based upon bandwidth calculations given limitations and other variables.</span></span>  

### <a name="tcp-max-segment-size"></a><span data-ttu-id="8ac59-464">TCP 最大區段大小</span><span class="sxs-lookup"><span data-stu-id="8ac59-464">TCP Max Segment Size</span></span>

<span data-ttu-id="8ac59-465">位於 SYN-RCVD-SYN-RCVD/通知</span><span class="sxs-lookup"><span data-stu-id="8ac59-465">Found in the SYN - SYN/ACK.</span></span>  <span data-ttu-id="8ac59-466">執行這項檢查您已採取來確定 TCP 封包會設為執行的最大可能的資料量任何效能網路追蹤中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-466">Do this check in any performance network trace you've taken to ensure that TCP packets are configured to carry the maximum amount of data possible.</span></span>

<span data-ttu-id="8ac59-467">請參閱 < 的 1460 位元組資料傳輸的 MSS 為目標。</span><span class="sxs-lookup"><span data-stu-id="8ac59-467">The goal is to see a MSS of 1460 bytes for transmission of data.</span></span> <span data-ttu-id="8ac59-468">如果您正在背後的 proxy，或您使用 NAT，請記得在執行這項測試，從用戶端到 proxy/輸出/NAT 和 proxy/輸出/NAT 到 Office 365 為了獲得最佳結果 ！</span><span class="sxs-lookup"><span data-stu-id="8ac59-468">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="8ac59-469">這些是不同的 TCP 工作階段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-469">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-470">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-470">Tools</span></span>

<span data-ttu-id="8ac59-471">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-471">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-472">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-472">What to look for</span></span>

<span data-ttu-id="8ac59-473">TCP 最大區段大小 (MSS) 是另一個參數的三種方式信號交換在您的網路追蹤，表示您可以在 SYN-RCVD-SYN-RCVD/ACK 封包中找到所需的資料。</span><span class="sxs-lookup"><span data-stu-id="8ac59-473">TCP Max Segment Size (MSS) is another parameter of the three-way handshake in your network trace, that means you'll find the data you need in the SYN - SYN/ACK packet.</span></span> <span data-ttu-id="8ac59-474">MSS 是若要查看實際相當簡單。</span><span class="sxs-lookup"><span data-stu-id="8ac59-474">MSS is actually pretty simple to see.</span></span>

<span data-ttu-id="8ac59-475">開啟任何效能網路追蹤您有並找出您想要了解，連線或來示範效能問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-475">Open any performance network trace you have and find the connection you're curious about, or that demonstrates the performance problem.</span></span>

> [!NOTE]
> <span data-ttu-id="8ac59-476">如果您查看追蹤，且需要來尋找您交談相關的流量，會依用戶端的 IP 或 proxy 伺服器或輸出點，或兩者的 IP 篩選。</span><span class="sxs-lookup"><span data-stu-id="8ac59-476">If you are looking at a trace and need to find the traffic relevant to your conversation, filter by the IP of the Client, or the IP of the proxy server or egress point, or both.</span></span> <span data-ttu-id="8ac59-477">直接移，您將需要 ping 您正在所測試的 Office 365 中的追蹤和篩選器的 IP 位址的 URL。</span><span class="sxs-lookup"><span data-stu-id="8ac59-477">Going directly, you will need to ping the URL that you're testing for the IP address of Office 365 in the trace, and filter by it.</span></span>

<span data-ttu-id="8ac59-478">查看 second-hand 追蹤嗎？</span><span class="sxs-lookup"><span data-stu-id="8ac59-478">Looking at the trace second-hand?</span></span> <span data-ttu-id="8ac59-479">請嘗試使用篩選器來引導您自己。</span><span class="sxs-lookup"><span data-stu-id="8ac59-479">Try using filters to orient yourself.</span></span> <span data-ttu-id="8ac59-480">在 Netmon，執行搜尋，根據 URL，例如： `Containsbin(framedata, ascii, "sphybridExample")`，記下數目的圖文框。</span><span class="sxs-lookup"><span data-stu-id="8ac59-480">In Netmon, run a search based on the URL, such as `Containsbin(framedata, ascii, "sphybridExample")`, take note of the frame number.</span></span>

<span data-ttu-id="8ac59-481">在 Wireshark 中使用的是`frame contains "sphybridExample"`。</span><span class="sxs-lookup"><span data-stu-id="8ac59-481">In Wireshark use something like  `frame contains "sphybridExample"`.</span></span> <span data-ttu-id="8ac59-482">如果您注意到您已經找到 （它可能會顯示為 [PSH，ACK] Wireshark 中） 的遠端 Winsock (RWS) 流量，請記得 RWS 連線可以查看相關 SYN-RCVD-SYN-RCVD/認可之前，即稍早所述。</span><span class="sxs-lookup"><span data-stu-id="8ac59-482">If you notice that you've found Remote Winsock (RWS) traffic (it may appear as a [PSH, ACK] in Wireshark), remember that RWS connects can be seen shortly before relevant SYN - SYN/ACKs, as discussed earlier.</span></span>

<span data-ttu-id="8ac59-483">此時，記錄的圖文框號碼、 卸除篩選、 按一下 [若要查看最接近 SYN.Netmon 中的 [網路交談] 視窗中的**所有流量**</span><span class="sxs-lookup"><span data-stu-id="8ac59-483">At this point, you can record the frame number, drop the filter, click **All Traffic** in the Network Conversations window in Netmon to look at the nearest SYN.</span></span>

<span data-ttu-id="8ac59-484">重要的，如果您未收到任何追蹤當時的 IP 位址資訊，請尋找 URL 追蹤中 (的一部分`sphybridExample-my.sharepoint.com`，例如)，可讓您篩選依據的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="8ac59-484">Importantly, if you didn't receive any of the IP address information at the time of the trace, finding your URL in the trace (part of `sphybridExample-my.sharepoint.com`, for example), will give you IP addresses to filter by.</span></span>

<span data-ttu-id="8ac59-485">追蹤您感興趣看到中尋找的連線。</span><span class="sxs-lookup"><span data-stu-id="8ac59-485">Locate the connection in the trace that you're interested in seeing.</span></span> <span data-ttu-id="8ac59-486">您可能會由篩選透過 IP 位址，或選取特定的交談 Id 使用網路交談視窗在 Netmon 中的任一掃描追蹤，來執行這項操作。</span><span class="sxs-lookup"><span data-stu-id="8ac59-486">You may do this by either scanning the trace, by filtering by IP addresses, or by selecting specific Conversation IDs using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="8ac59-487">一旦您已經找到 SYN-RCVD 封包，展開 [TCP （在 Netmon) 或傳輸控制通訊協定 （在 Wireshark) 中 [圖文框的詳細資訊] 面板。</span><span class="sxs-lookup"><span data-stu-id="8ac59-487">Once you've found the SYN packet, expand TCP (in Netmon), or Transmission Control Protocol (in Wireshark) in the Frame Details panel.</span></span> <span data-ttu-id="8ac59-488">展開 [TCP 選項及 MaxSegmentSize。</span><span class="sxs-lookup"><span data-stu-id="8ac59-488">Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="8ac59-489">找出相關的接收圖文框，依序展開 [TCP 選項和 MaxSegmentSize。</span><span class="sxs-lookup"><span data-stu-id="8ac59-489">Locate the related SYN-ACK frame and Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="8ac59-490">較小的兩個值會是您最大區段大小。</span><span class="sxs-lookup"><span data-stu-id="8ac59-490">The smaller of the two values will be your Maximum Segment Size.</span></span> <span data-ttu-id="8ac59-491">此圖中，我請使用名為 TCP 疑難排解 Netmon 中的內建欄。</span><span class="sxs-lookup"><span data-stu-id="8ac59-491">In this picture, I make use of the built-in Column in Netmon called TCP Troubleshoot.</span></span>  

![使用內建欄在 Netmon 中篩選的網路追蹤。](media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

<span data-ttu-id="8ac59-493">內建欄是頂端的 [**圖文框的詳細資訊**] 面板。</span><span class="sxs-lookup"><span data-stu-id="8ac59-493">The built-in column is at the top of the **Frame Details** panel.</span></span> <span data-ttu-id="8ac59-494">（若要切換回標準檢視，再按一下 [**欄**]，，然後選擇 [**時間的時區**）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-494">(To switch back to your normal view, click **Columns** again, and then choose **Time Zone**.)</span></span>

![在欄位下拉式清單中尋找 TCP 疑難排解選項 (在框架摘要的頂端)。](media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

<span data-ttu-id="8ac59-496">以下是在 Wireshark 中的已篩選的追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-496">Here's a filtered trace in Wireshark.</span></span> <span data-ttu-id="8ac59-497">沒有特定的 MSS 值的篩選器 ( `tcp.options.mss`)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-497">There is a filter specific to the MSS value ( `tcp.options.mss`).</span></span> <span data-ttu-id="8ac59-498">SYN-RCVD、 SYN-RCVD/ACK、 ACK 信號交換的框架連結底部的 Wireshark 等於圖文框的詳細資訊 （因此框架 47 ACK、 46 SYN-RCVD/ACK 連結、 43 SYN-RCVD 連結） 以方便這類的工作。</span><span class="sxs-lookup"><span data-stu-id="8ac59-498">The frames of a SYN, SYN/ACK, ACK handshake are linked at the bottom of the Wireshark equivalent to Frame Details (so frame 47 ACK, links to 46 SYN/ACK, links to 43 SYN) to make this kind of work easier.</span></span>

![在 Wireshark 中由 tcp.options.mss 篩選的最大區段大小 (MSS) 的篩選的追蹤。](media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

<span data-ttu-id="8ac59-500">如果您需要檢查**選擇性認可**（此矩陣中的下一個主題），不要關閉您追蹤 ！</span><span class="sxs-lookup"><span data-stu-id="8ac59-500">If you need to check **Selective Acknowledgment** (next topic in this matrix), don't close your trace!</span></span>

### <a name="selective-acknowledgment"></a><span data-ttu-id="8ac59-501">選擇性認可</span><span class="sxs-lookup"><span data-stu-id="8ac59-501">Selective Acknowledgment</span></span>

<span data-ttu-id="8ac59-502">位於 SYN-RCVD-SYN-RCVD/通知</span><span class="sxs-lookup"><span data-stu-id="8ac59-502">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="8ac59-503">必須報告為 SYN-RCVD 和 SYN-RCVD/通知中的許可</span><span class="sxs-lookup"><span data-stu-id="8ac59-503">Must be reported as Permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="8ac59-504">選擇性認可 (SACK) 可讓更順暢地重新傳輸的資料封包或封包移遺失時。</span><span class="sxs-lookup"><span data-stu-id="8ac59-504">Selective Acknowledgment (SACK) allows for smoother retransmission of data when a packet or packets go missing.</span></span> <span data-ttu-id="8ac59-505">裝置可以停用此功能，可能會導致效能問題。</span><span class="sxs-lookup"><span data-stu-id="8ac59-505">Devices can disable this feature, which can lead to performance problems.</span></span>

<span data-ttu-id="8ac59-506">如果您正在背後的 proxy，或您使用 NAT，請記得在執行這項測試，從用戶端到 proxy/輸出/NAT 和 proxy/輸出/NAT 到 Office 365 為了獲得最佳結果 ！</span><span class="sxs-lookup"><span data-stu-id="8ac59-506">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="8ac59-507">這些是不同的 TCP 工作階段。</span><span class="sxs-lookup"><span data-stu-id="8ac59-507">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-508">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-508">Tools</span></span>

<span data-ttu-id="8ac59-509">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-509">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-510">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-510">What to look for</span></span>

<span data-ttu-id="8ac59-511">選擇性認可 (SACK) 是另一個參數中的 SYN-RCVD/接收信號交換。</span><span class="sxs-lookup"><span data-stu-id="8ac59-511">Selective Acknowledgment (SACK) is another parameter in the SYN-SYN/ACK handshake.</span></span> <span data-ttu-id="8ac59-512">您可以篩選 SYN-RCVD-SYN-RCVD/ACK 許多方式您追蹤。</span><span class="sxs-lookup"><span data-stu-id="8ac59-512">You can filter your trace for SYN - SYN/ACK many ways.</span></span>

<span data-ttu-id="8ac59-513">追蹤您感興趣由掃描追蹤，請參閱篩選的 IP 位址，或按一下 [使用網路交談視窗在 Netmon 中的交談 ID 中尋找的連線。</span><span class="sxs-lookup"><span data-stu-id="8ac59-513">Locate the connection in the trace that you're interested in seeing either by scanning the trace, filtering by IP addresses, or by clicking a Conversation ID using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="8ac59-514">一旦您已經找到 SYN-RCVD 封包，展開 [TCP 在 Netmon 或 Wireshark 中框架詳細資料] 區段中的傳輸控制通訊協定。</span><span class="sxs-lookup"><span data-stu-id="8ac59-514">Once you've found the SYN packet, expand TCP in Netmon, or Transmission Control Protocol in Wireshark in the Frame Details section.</span></span> <span data-ttu-id="8ac59-515">展開 [TCP 選項，然後 SACK。</span><span class="sxs-lookup"><span data-stu-id="8ac59-515">Expand TCP Options and then SACK.</span></span> <span data-ttu-id="8ac59-516">找出相關的接收圖文框和展開 TCP 選項，以及其 SACK] 欄位。</span><span class="sxs-lookup"><span data-stu-id="8ac59-516">Locate the related SYN-ACK frame and Expand TCP Options and its SACK field.</span></span> <span data-ttu-id="8ac59-517">請確定 SACK 允許 SYN-RCVD 和 SYN-RCVD/通知</span><span class="sxs-lookup"><span data-stu-id="8ac59-517">Make certain SACK is permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="8ac59-518">Netmon 及 Wireshark 中所見，以下是 SACK 值。</span><span class="sxs-lookup"><span data-stu-id="8ac59-518">Here are SACK values as seen in both Netmon and Wireshark.</span></span>

![選擇性認可 (SACK) 在 Netmon 中結果的 tcp.flags.syn = = 1。](media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![Wireshark 中所示的 SACK 及篩選器 tcp.flags.syn == 1。](media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a><span data-ttu-id="8ac59-521">DNS Geolocation</span><span class="sxs-lookup"><span data-stu-id="8ac59-521">DNS Geolocation</span></span>

<span data-ttu-id="8ac59-522">其中領域中 Office 365 會嘗試解決您的 DNS 呼叫效果您的連線速度。</span><span class="sxs-lookup"><span data-stu-id="8ac59-522">Where in the world Office 365 tries to resolve your DNS call effects your connection speed.</span></span>

<span data-ttu-id="8ac59-523">在 Outlook Online 中，第一個 DNS 查閱完成後，該 DNS 的位置將用來連線到最接近的資料中心。</span><span class="sxs-lookup"><span data-stu-id="8ac59-523">In Outlook Online, after the first DNS lookup is completed, the location of that DNS will be used to connect to your nearest datacenter.</span></span> <span data-ttu-id="8ac59-524">您將會連線到 Outlook 線上 CAS 伺服器，用以骨幹網路連線到資料中心 (dC) 儲存您的資料。</span><span class="sxs-lookup"><span data-stu-id="8ac59-524">You will be connected to an Outlook Online CAS server, which will use the backbone network to connect to the datacenter (dC) where your data is stored.</span></span> <span data-ttu-id="8ac59-525">這是更快。</span><span class="sxs-lookup"><span data-stu-id="8ac59-525">This is faster.</span></span>

<span data-ttu-id="8ac59-526">當存取 SharePoint Online、 強人出差的使用者會被導向到其作用中的資料中心-，其位置根據其 SPO 租用戶 dC 的首頁基底 (因此，在美國 dC 如果使用者如果 USA 為基礎)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-526">When accessing SharePoint Online, a user traveling abroad will be directed to their active datacenter -- that's the dC whose location is based on their SPO tenant's home-base (so, a dC in the USA if the user if USA-based).</span></span>

<span data-ttu-id="8ac59-527">Lync online 中一個以上的 dC 有作用中的節點，一次。</span><span class="sxs-lookup"><span data-stu-id="8ac59-527">Lync online has active nodes in more than one dC at a time.</span></span> <span data-ttu-id="8ac59-528">要求時傳送的 Lync online 執行個體，Microsoft 的 DNS 會決定在世界要求來自何處，並傳回 IP 位址從最接近的地區 dC 其中 Lync online 是作用中。</span><span class="sxs-lookup"><span data-stu-id="8ac59-528">When requests are sent for Lync online instances, Microsoft's DNS will determine where in the world the request came from, and return IP addresses from the nearest regional dC where Lync online is active.</span></span>

> [!TIP]
> <span data-ttu-id="8ac59-529">若要深入了解用戶端如何連線到 Office 365 的需要嗎？</span><span class="sxs-lookup"><span data-stu-id="8ac59-529">Need to know more about how clients connect to Office 365?</span></span> <span data-ttu-id="8ac59-530">看看[用戶端連線](https://technet.microsoft.com/en-us/library/dn741250.aspx)參考文章 （和其很有幫助的圖形）。</span><span class="sxs-lookup"><span data-stu-id="8ac59-530">Take a look at the [Client Connectivity](https://technet.microsoft.com/en-us/library/dn741250.aspx) reference article (and its helpful graphics).</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-531">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-531">Tools</span></span>

- <span data-ttu-id="8ac59-532">Ping</span><span class="sxs-lookup"><span data-stu-id="8ac59-532">Ping</span></span>
- <span data-ttu-id="8ac59-533">PsPing</span><span class="sxs-lookup"><span data-stu-id="8ac59-533">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="8ac59-534">要尋找的項目</span><span class="sxs-lookup"><span data-stu-id="8ac59-534">What to look for</span></span>

<span data-ttu-id="8ac59-535">在大部分情況下結果中傳回地區性資料中心 (dC) 的 IP 位址的 Microsoft DNS 中應從用戶端的 DNS 伺服器的名稱解析到 Microsoft 的 DNS 伺服器的要求。</span><span class="sxs-lookup"><span data-stu-id="8ac59-535">Requests for name resolution from the client's DNS servers to Microsoft's DNS servers should in most cases result in Microsoft DNS returning the IP address of a regional datacenter (dC).</span></span> <span data-ttu-id="8ac59-536">這代表您什麼？</span><span class="sxs-lookup"><span data-stu-id="8ac59-536">What does this mean for you?</span></span> <span data-ttu-id="8ac59-537">如果您總部位於班加羅爾 （印度），但您的瀏覽器的 Outlook 線上提出要求時，在出差在美國，，Microsoft 的 DNS 伺服器應該處理您的 IP 位址在美國境內-地區性資料中心的資料中心。</span><span class="sxs-lookup"><span data-stu-id="8ac59-537">If your headquarters are in Bangalore, India, but you are traveling in the United States, when your browser makes a request for Outlook Online, Microsoft's DNS servers should hand you IP addresses to datacenters in the United States -- a regional datacenter.</span></span> <span data-ttu-id="8ac59-538">如果郵件來自 Outlook 需要時，該資料將會流經 Microsoft 的快速骨幹網路資料中心之間。</span><span class="sxs-lookup"><span data-stu-id="8ac59-538">If mail is needed from Outlook, that data will travel across Microsoft's quick backbone network between the datacenters.</span></span>

<span data-ttu-id="8ac59-539">如果完成名稱解析為最接近使用者位置開始儘可能 DNS 的運作最快。</span><span class="sxs-lookup"><span data-stu-id="8ac59-539">DNS works fastest when name resolution is done as close to the user location as possible.</span></span> <span data-ttu-id="8ac59-540">如果您是歐洲地區，您要移至 Microsoft 的 DNS 中歐洲 （理想狀況下） 處理歐洲地區資料中心。</span><span class="sxs-lookup"><span data-stu-id="8ac59-540">If you're in Europe, you want to go to a Microsoft DNS in Europe, and (ideally) deal with a datacenter in Europe.</span></span> <span data-ttu-id="8ac59-541">移至 [DNS 及 America 的資料中心歐洲的用戶端的效能將會變慢。</span><span class="sxs-lookup"><span data-stu-id="8ac59-541">Performance from a client in Europe going to DNS and a datacenter in America will be slower.</span></span>

<span data-ttu-id="8ac59-542">對 outlook.office365.com 至判斷其中領域中您的 DNS 要求被路由傳送執行 Ping 工具。</span><span class="sxs-lookup"><span data-stu-id="8ac59-542">Run the Ping tool against outlook.office365.com to determine where in the world your DNS request is being routed.</span></span> <span data-ttu-id="8ac59-543">如果您位於歐洲時，您應該會看到類似於 outlook emeawest.office365.com 的回覆。</span><span class="sxs-lookup"><span data-stu-id="8ac59-543">If you are in Europe, you should see a reply from something like outlook-emeawest.office365.com.</span></span> <span data-ttu-id="8ac59-544">美洲，預期 outlook namnorthwest.office365.com 類似。</span><span class="sxs-lookup"><span data-stu-id="8ac59-544">In the Americas, expect something like outlook-namnorthwest.office365.com.</span></span>

<span data-ttu-id="8ac59-545">開啟命令提示字元中，用戶端電腦上 (透過開始\>執行\>cmd 或 Windows 鍵\>輸入 cmd)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-545">Open the command prompt on the client computer (via Start \> Run \> cmd or Windows key \> type cmd).</span></span> <span data-ttu-id="8ac59-546">輸入 ping outlook.office365.com，然後按 ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="8ac59-546">Type ping outlook.office365.com and press ENTER.</span></span> <span data-ttu-id="8ac59-547">請記住，如果您想要指定透過 IPv4 ping 指定-4。</span><span class="sxs-lookup"><span data-stu-id="8ac59-547">Remember, to specify -4 if you want to specify to ping via IPv4.</span></span> <span data-ttu-id="8ac59-548">您可能無法從 ICMP 封包，取得回覆，但您應該會看到的要求被路由傳送的 DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="8ac59-548">You may fail to get a reply from the ICMP packets, but you should see the name of the DNS to which the request was routed.</span></span> <span data-ttu-id="8ac59-549">如果您想要看到此連線的延遲號碼會嘗試由 ping 傳回伺服器的 IP 位址 PsPing。</span><span class="sxs-lookup"><span data-stu-id="8ac59-549">If you want to see the latency numbers for this connection try PsPing to the IP address of the server that is returned by ping.</span></span>  

![outlook.office365.com 的 Ping，顯示 outlook-namnorthwest 中的解析。](media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![由 ping 傳回給 outlook.office365.com 顯示平均 28 毫秒的延遲的 IP 位址 PSPing。](media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a><span data-ttu-id="8ac59-552">Office 365 應用程式疑難排解</span><span class="sxs-lookup"><span data-stu-id="8ac59-552">Office 365 Application Troubleshooting</span></span>

#### <a name="tools"></a><span data-ttu-id="8ac59-553">工具</span><span class="sxs-lookup"><span data-stu-id="8ac59-553">Tools</span></span>

- <span data-ttu-id="8ac59-554">Netmon</span><span class="sxs-lookup"><span data-stu-id="8ac59-554">Netmon</span></span>
- <span data-ttu-id="8ac59-555">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="8ac59-555">HTTPWatch</span></span>
- <span data-ttu-id="8ac59-556">在瀏覽器中的 F12 主控台</span><span class="sxs-lookup"><span data-stu-id="8ac59-556">F12 Console in the browser</span></span>

<span data-ttu-id="8ac59-557">我們不涵蓋中特定應用程式疑難排解特定網路的本文中所使用的工具。</span><span class="sxs-lookup"><span data-stu-id="8ac59-557">We don't cover tools used in application-specific troubleshooting in this network-specific article.</span></span> <span data-ttu-id="8ac59-558">您可以找到的資源，但您*可以*使用[此頁面上](https://support.office.com/en-us/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848)。</span><span class="sxs-lookup"><span data-stu-id="8ac59-558">But you'll find resources you  *can*  use [on this page](https://support.office.com/en-us/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8ac59-559">相關主題</span><span class="sxs-lookup"><span data-stu-id="8ac59-559">Related Topics</span></span>

[<span data-ttu-id="8ac59-560">管理 Office 365 端點</span><span class="sxs-lookup"><span data-stu-id="8ac59-560">Managing Office 365 endpoints</span></span>](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)
  
<span data-ttu-id="8ac59-561">[Office 365 端點常見問題集](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d) (機器翻譯)</span><span class="sxs-lookup"><span data-stu-id="8ac59-561">[Office 365 endpoints FAQ](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)</span></span>
